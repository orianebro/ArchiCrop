[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "PhD Oriane",
    "section": "",
    "text": "Preface\nThis book keeps track of the work made during the PhD of Oriane Braud, entitled “Multiscale hybrid modeling framework for intercrops: the best of plant and crop models”. This PhD is carried out from November 2023 to 2026 at CIRAD (UMRs AGAP and AMAP), as part of European project IntercropValuES, and is supervised by Myriam Adam, Marc Jaeger, Christophe Pradal, Remi Vezy and Thomas Arsouze.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "abstract.html",
    "href": "abstract.html",
    "title": "Abstract",
    "section": "",
    "text": "1. Concevoir un FSPM contraint par un modèle de culture pour les cultures intercalaires\nUn FSPM dynamique paramétrique, aérien et racinaire, adapté pour les céréales et les légumineuses, et visant à être contraint par les sorties d’un modèle de culture (par exemple, reconstruire la croissance et le développement d’une plante à partir du LAI et de la hauteur du couvert pour la partie aérienne) est en cours de création.\nCela laisse autant de degrés de liberté que la structure 3D implémentée dans le modèle le permet, et donc une variabilité architecturale aussi grande qu’il y a de paramètres architecturaux. En somme, le but est de pouvoir représenter un modèle de culture avec une structure 3D et un arrangement spatial explicite des cultures intercalaires.\nRéalisation : modèle FSPM",
    "crumbs": [
      "Abstract"
    ]
  },
  {
    "objectID": "abstract.html#identifier-les-processus-perfectibles-des-modèles-de-culture",
    "href": "abstract.html#identifier-les-processus-perfectibles-des-modèles-de-culture",
    "title": "Abstract",
    "section": "2. Identifier les processus perfectibles des modèles de culture",
    "text": "2. Identifier les processus perfectibles des modèles de culture\nEn utilisant le FSPM précédemment créé, il sera possible, pour une simulation avec un modèle de culture, d’en obtenir un grand nombre en explorant un espace phénotypique défini pour chaque espèce par les paramètres architecturaux non pris en compte dans le modèle de culture, ainsi qu’en modifiant l’arrangement spatial explicite des cultures intercalaires. Une vaste expérience de simulation sera réalisée pour comprendre comment les différents processus (interception de la lumière, absorption de l’eau et de l’azote, etc.) sont modifiés en fonction des variations des caractéristiques architecturales des plantes, de l’arrangement spatial des cultures intercalaires, mais aussi en tenant compte de l’échelle spatiale et temporelle des processus simulés.\nDes analyses statistiques (comparaison de moyennes, analyse de la variance, de propagation d’incertitude, de sensibilité) seront faites sur les sorties de ces simulations pour identifier les processus pour lesquels la prise en compte d’échelles plus fines a une influence, ainsi que des paramètres d’intérêt.\nLes espèces et variétés de plantes utilisées pour simuler les cultures intercalaires seront choisies en fonction de la paramétrisation existante de STICS pour les cultures intercalaires, ainsi que des expériences disponibles dans le projet IntercropValuES.\nRéalisation : méthodologie + application avec STICS",
    "crumbs": [
      "Abstract"
    ]
  },
  {
    "objectID": "abstract.html#tester-différentes-approches-pour-améliorer-la-prise-en-compte-des-paramètres-structuraux-dintérêt-pour-la-modélisation-des-cultures-intercalaires-dans-les-formalismes-du-modèle-de-culture-stics-intercrop-avec-une-approche-multi-échelle",
    "href": "abstract.html#tester-différentes-approches-pour-améliorer-la-prise-en-compte-des-paramètres-structuraux-dintérêt-pour-la-modélisation-des-cultures-intercalaires-dans-les-formalismes-du-modèle-de-culture-stics-intercrop-avec-une-approche-multi-échelle",
    "title": "Abstract",
    "section": "3. Tester différentes approches pour améliorer la prise en compte des paramètres structuraux d’intérêt pour la modélisation des cultures intercalaires dans les formalismes du modèle de culture STICS-Intercrop avec une approche multi-échelle",
    "text": "3. Tester différentes approches pour améliorer la prise en compte des paramètres structuraux d’intérêt pour la modélisation des cultures intercalaires dans les formalismes du modèle de culture STICS-Intercrop avec une approche multi-échelle\nLes processus identifiés précédemment seront étudiés à différentes échelles spatiales et temporelles. Pour passer d’une échelle (par exemple l’échelle de l’organe) à une autre (par exemple l’échelle de la culture), plusieurs stratégies seront étudiées : comment trouver un modèle analytique équivalent pour l’absorption d’eau en utilisant des hypothèses homogènes (Couveur et al., 2012) ? Comment estimer un modèle de substitution basé sur la sortie du modèle à une échelle plus fine pour capturer les propriétés émergentes ? Ou encore, comment concevoir des modèles hybrides en combinant des modules existants à la même échelle ou à des échelles différentes ?\nCela conduira à de nouveaux formalismes dans le modèle de culture.\nRéalisation : nouveaux formalismes pour la prochaine version de STICS",
    "crumbs": [
      "Abstract"
    ]
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "1  Introduction",
    "section": "",
    "text": "In progress …\nTalk about intercropping as an agro-ecological practice, the barriers, the importance of modeling, the existing models (crop and FSPM) and their characteristics, their limits as for modeling intercrops, focus on evaluating how hypotheses in crop models are off the mark, for processes occuring in shoot and root, and how to modify the formalisms corresping to processes that are off the mark in STICS crop model in particular.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "year_1.html",
    "href": "year_1.html",
    "title": "First chapter: Analyzing accuracy of formalisms in crop model when adding shoot structural variability",
    "section": "",
    "text": "Analysis - shoot: Does considering plant shoot structural variability change a crop model’s outputs in an intercropping context ?\nHypothesis: The error of crop models, when it comes to modeling intercrops, are mainly due to the average plant hypothesis and the non-consideration of the plant shoot architecture.\nIs the variability generated by structural considerations large enough to unvalidate crop model hypotheses ?\nWhat is the sensitivity of intercrops to variations of plant structure (and spatial arrangement) ?\nHow do the uncertainties linked to crop model hypotheses propagate when considering plant structure ?\nDevelop a dynamic shoot parametric FSPM for each type of plant (cereals and legumes, inspiration from OpenAlea models Cereal, L-Pea, WeberPenn, etc., to adapt for intercrops for which we have data), where growth is constrained by outputs from a crop model (e.g. LAI(t) and height(t)), leaving degrees of freedom for features that are not explicitly considered in the crop model (e.g. plant architecture and spatial arrangement).\nImplement well-known structural reactions to stresses.\n(march -&gt; may 2024)\nRun simulations of various GxGxExM with both FSPM and STICS (stressless and stressed conditions : Vezy et al., 2023; Traore et al., 2022, 2023), varying (define variations ranges) when possible: shoot structures (explore phenotypic space, i.e. create many morphotypes), spatial arrangement (with all same plants or all different to separate effects), env/stresses (N, water, light)\n(june -&gt; august 2024)\nFrom outputs from my models and from STICS for given processes and given conditions:\n- Compare means and analyze variance of chosen output variables: light intercepted, RUE, N demand /organ, etc.\n- Analyse uncertainty propagation in simulations. Expected results: see which processes are the most impacted by the uncertainty in crop model outputs.\n- Analyse sensitivity of some plant processes to structural variability and spatial heterogeneity. Expected results: spot parameters of interest that can make a change if better considered in a crop model when modeling intercrops.\nUnvalidate some formalisms in STICS (september -&gt; december 2024)",
    "crumbs": [
      "First chapter: Analyzing accuracy of formalisms in crop model when adding shoot structural variability"
    ]
  },
  {
    "objectID": "intro_1.html",
    "href": "intro_1.html",
    "title": "2  Introduction",
    "section": "",
    "text": "In progress …",
    "crumbs": [
      "First chapter: Analyzing accuracy of formalisms in crop model when adding shoot structural variability",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "structural_cereal_model.html",
    "href": "structural_cereal_model.html",
    "title": "3  Structural cereal model",
    "section": "",
    "text": "3.1 Create a parametric leaf\nThe leaf blade is represented as a surface.\nA parametric leaf is here defined by sample points (here 12), described by two sets of coordinates:\n- \\((x,y)\\): coordinates for the midrib in a vertical plane, give the curvature of the leaf;\n- \\((s,r)\\): curviliear abcissa (i.e. length along midrib) and relative length-dependent leaf width.\nNote that \\(s\\) can be expressed as a function of \\(x\\) and \\(y\\), at point \\(p \\neq 0\\), as follows: $ s_p(x,y) = $.\nThe origin represents the leaf base.\nCode\n## Imports\n\n# from installed packages\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom heapq import *\nfrom scipy.interpolate import splprep, splev\nfrom scipy.integrate import simps, trapz\nfrom openalea.plantgl.all import Vector3\n\n# from archicrop\nfrom archicrop.cereals_leaf import leaf_shape_perez, sr_prevot, parametric_leaf\n# or\n# from archicrop.simple_maize import leaf_shape_perez, sr_prevot, parametric_leaf\n# from archicrop.fitting import leaf_shape_perez\nfrom archicrop.generator import curvilinear_abscisse\nfrom archicrop.fitting import fit2, fit3, simplify\nfrom archicrop.simplification import distance, cost\n\n## Code for generating a parametric leaf for a cereal \npl=parametric_leaf(nb_segment=10, insertion_angle=40, scurv=0.7, curvature=70, alpha=-2.3)\n\nfig, (ax1, ax2) = plt.subplots(nrows=2) \n# fig.suptitle('Parametric leaf')\n\nax1.plot(pl[0], pl[1], '.-', c=\"green\")\nax1.set_xlabel('x')\nax1.set_ylabel('y')\nax1.set_title(\"Coordinates of the midrib in a vertical plane\")\n\nax2.plot(pl[2], pl[3], '.-', c=\"green\")\nax2.plot(pl[2], -pl[3], '.-', c=\"green\")\nax2.plot(np.arange(0,1.1,0.1), np.zeros(11), c=\"green\", ls=\"dashed\")\nax2.set_xlabel('s')\nax2.set_ylabel('r')\nax2.set_title(\"Flattened leaf shape\")\n\nplt.subplots_adjust(hspace=0.5)\n\nplt.show()\nCode\n## Imports\n\n# from installed packages\nfrom mpl_toolkits.mplot3d import Axes3D\nfrom scipy.interpolate import interp2d\nimport matplotlib.tri as mtri\n\n# from archicrop\nfrom archicrop.fitting import leaf_to_mesh_2d\n\n## Code for representing the parametric leaf in 3D (ignore excess lines)\nx=pl[0]\ny=pl[1]\ns=pl[2]\nr=pl[3]\n\npts,ind=leaf_to_mesh_2d(x, y, r)\n\nxs=[pt[0] for pt in pts]\nys=[pt[1] for pt in pts]\nzs=[pt[2] for pt in pts]\n    \nX,Y=np.meshgrid(xs, ys)\n\ntri=mtri.Triangulation(xs, ys)\n\nfig=plt.figure()\nax=fig.add_subplot(111, projection='3d')\nax.scatter(xs,ys,zs,c=\"green\")\nax.plot(xs,ys,zs,c=\"green\")\nax.plot(xs,np.zeros(len(ys)),zs,c=\"green\",ls=\"dashed\")\nax.set_title(\"3D representation of a leaf shape with curvature\")\nplt.show()\nPlease ignore excess straight lines.",
    "crumbs": [
      "First chapter: Analyzing accuracy of formalisms in crop model when adding shoot structural variability",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Structural cereal model</span>"
    ]
  },
  {
    "objectID": "structural_cereal_model.html#generate-leaf-azimuth-series",
    "href": "structural_cereal_model.html#generate-leaf-azimuth-series",
    "title": "3  Structural cereal model",
    "section": "3.2 Generate leaf azimuth series",
    "text": "3.2 Generate leaf azimuth series\nLeaves grow around an axis with a given phyllotaxy, represented here as an angle from leaf to leaf (e.g. spiral with a given angle or alternate distichous = \\(180^o\\)).\n\n\nCode\n## Imports\n\n# from installed packages \n# from itertools import cycle\n\n# from archicrop\nfrom archicrop.plant_design import leaf_azimuth\n\n## Code for generating leaf azimuths series for a given phyllotaxy\nnb_phy=10\nphyllotactic_angle=137\nspiral=True\nphyllotactic_deviation=0\nplant_orientation=0\n\nla=leaf_azimuth(size=nb_phy, \n                phyllotactic_angle=phyllotactic_angle, \n                phyllotactic_deviation=phyllotactic_deviation, \n                plant_orientation=plant_orientation, \n                spiral=spiral)\n\nx=np.cos(la*np.pi/180)\ny=np.sin(la*np.pi/180)\nz=np.linspace(1,len(la)+1,len(la))\n\nfig,ax=plt.subplots(subplot_kw=dict(projection='3d'))\nfor i,a in enumerate(la):\n    ax.plot(np.linspace(0,x[i],2), np.linspace(0,y[i],2), [z[i],z[i]], c=\"green\")\nax.plot([0,0], [0,0], [0,z[-1]], c=\"green\")\n\nax.set_title(\"3D representation of phyllotaxy\")\n\nplt.show()",
    "crumbs": [
      "First chapter: Analyzing accuracy of formalisms in crop model when adding shoot structural variability",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Structural cereal model</span>"
    ]
  },
  {
    "objectID": "structural_cereal_model.html#manage-internode-lengths",
    "href": "structural_cereal_model.html#manage-internode-lengths",
    "title": "3  Structural cereal model",
    "section": "3.3 Manage internode lengths",
    "text": "3.3 Manage internode lengths\nInternodes on an axis have varying lengths. The repartition of their lengths along the axis can be approximated with a geometric model.\n\n\nCode\n## Imports\nfrom archicrop.plant_shape import geometric_dist\n\n## Code for applying lengths to internodes according to a geometric model\nplant_height=15\nq=1.5\n\nx=np.cos(la*np.pi/180)\ny=np.sin(la*np.pi/180)\nz=geometric_dist(height=plant_height, \n                   nb_phy=nb_phy, \n                   q=q)\n\nfig,ax=plt.subplots(subplot_kw=dict(projection='3d'))\nfor i,a in enumerate(la):\n    ax.plot(np.linspace(0,x[i],2), np.linspace(0,y[i],2), [z[i],z[i]], c=\"green\")\nax.plot([0,0], [0,0], [0,z[-1]], c=\"green\")\n\nax.set_title(\"3D representation of the repartition of internode length along the stem\")\n\nplt.show()",
    "crumbs": [
      "First chapter: Analyzing accuracy of formalisms in crop model when adding shoot structural variability",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Structural cereal model</span>"
    ]
  },
  {
    "objectID": "structural_cereal_model.html#manage-leaf-lengths-as-a-function-of-height",
    "href": "structural_cereal_model.html#manage-leaf-lengths-as-a-function-of-height",
    "title": "3  Structural cereal model",
    "section": "3.4 Manage leaf lengths as a function of height",
    "text": "3.4 Manage leaf lengths as a function of height\nLeaves that grow on an axis have varying lengths. The repartition of their lengths along the axis can be approximated with a bell shaped model.\n\n\nCode\n## Imports\nfrom archicrop.plant_shape import bell_shaped_dist\n\n## Code for applying lengths to leaves according to a bell shaped model\nmax_leaf_length=50\n\nbsd=bell_shaped_dist(max_leaf_length=max_leaf_length, \n                     nb_phy=nb_phy, \n                     rmax=.8, \n                     skew=0.15)\n\nx=np.cos(la*np.pi/180)*bsd\ny=np.sin(la*np.pi/180)*bsd\nz=geometric_dist(height=plant_height, \n                   nb_phy=nb_phy, \n                   q=q)\n\nfig, ax = plt.subplots(subplot_kw=dict(projection='3d'))\nfor i,a in enumerate(la):\n    ax.plot(np.linspace(0,x[i],2), np.linspace(0,y[i],2), [z[i],z[i]], c=\"green\")\nax.plot([0,0], [0,0], [0,z[-1]], c=\"green\")\n\nax.set_title(\"3D representation of the repartition of leaf length along the stem\")\n\nplt.show()",
    "crumbs": [
      "First chapter: Analyzing accuracy of formalisms in crop model when adding shoot structural variability",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Structural cereal model</span>"
    ]
  },
  {
    "objectID": "structural_cereal_model.html#arrange-a-leaf-to-be-placed-along-a-stem-with-a-given-inclination.",
    "href": "structural_cereal_model.html#arrange-a-leaf-to-be-placed-along-a-stem-with-a-given-inclination.",
    "title": "3  Structural cereal model",
    "section": "3.5 Arrange a leaf to be placed along a stem with a given inclination.",
    "text": "3.5 Arrange a leaf to be placed along a stem with a given inclination.\nA leaf must undergo a translation to be placed against the surface of the stem (tangent to it), and a rotation to be tilted like the stem (inclination = 1 if main stem).\n\n\nCode\n## Imports\n\n# from installed packages\nfrom math import pi, cos, sin, radians\nimport openalea.plantgl.all as pgl\n\n# from archicrop\n# from archicrop.cereals_leaf import arrange_leaf\n# or \nfrom archicrop.geometry import arrange_leaf\n\n## Code for placing a leaf against a stem element (here a cylinder), with a given inclination\nstem_diameter=0.5\ninclination=1\n\nal=arrange_leaf(leaf=pl, \n                stem_diameter=stem_diameter, \n                inclination=inclination, \n                relative=True)\n\nx=al[0]\ny=al[1]\ns=al[2]\nr=al[3]\n\npts,ind=leaf_to_mesh_2d(x, y, r)\n\nxs=[pt[0] for pt in pts]\nys=[pt[1] for pt in pts]\nzs=[pt[2] for pt in pts]\n    \nX,Y=np.meshgrid(xs, ys)\n\ntri=mtri.Triangulation(xs, ys)\n\nfig=plt.figure()\nax=fig.add_subplot(111, projection='3d')\nax.plot(xs,ys,zs,c=\"green\")\nax.plot([xs[0],xs[0]],[ys[0],-ys[0]],[0,0],c=\"green\")\nax.plot(xs,np.zeros(len(ys)),zs,c=\"green\",ls=\"dashed\")\n\nradius=stem_diameter/2\nz=np.linspace(-zs[-1], zs[-1])\ntheta=np.linspace(0, 2*np.pi)\ntheta_grid, z_stem=np.meshgrid(theta, z)\nx_stem=radius*np.cos(theta_grid)\ny_stem=radius*np.sin(theta_grid)\n\nax.plot_surface(x_stem, y_stem, z_stem, color=\"green\")\n\nax.set_title(\"3D representation of the placement of a leaf along a stem\")\n\nplt.show()",
    "crumbs": [
      "First chapter: Analyzing accuracy of formalisms in crop model when adding shoot structural variability",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Structural cereal model</span>"
    ]
  },
  {
    "objectID": "structural_cereal_model.html#build-the-whole-plant-shoot-in-3d-as-an-mtg.",
    "href": "structural_cereal_model.html#build-the-whole-plant-shoot-in-3d-as-an-mtg.",
    "title": "3  Structural cereal model",
    "section": "3.6 Build the whole plant shoot in 3D, as an MTG.",
    "text": "3.6 Build the whole plant shoot in 3D, as an MTG.\nAn MTG (Multiscale Tree Graph) is created as a representation of a parametrized cereal shoot.\nThe different scales are: - Plant\n- Axis\n- Metamer\n- Stem / Leaf\n- StemElement / LeafElement\n\n\nCode\n## Imports\n\n# from installed packages\nimport openalea.plantgl.all as pgl\nfrom openalea.mtg.turtle import TurtleFrame\nfrom openalea.mtg import MTG, fat_mtg\nfrom scipy.interpolate import interp1d\nimport pandas\n\n# from archicrop\nfrom archicrop.geometry import slim_cylinder, stem_mesh, _is_iterable, as_tuples, addSets, leaf_mesh, compute_element, mtg_interpreter\n# from archicrop.cereals_leaf import leaf_mesh\nfrom archicrop.geometry import CerealsTurtle, CerealsVisitor\nfrom archicrop.fitting import leaf_element, leaf_to_mesh_2d, leaf_to_mesh, mesh4, plantgl_shape   # leaf_to_mesh_new ?\nfrom archicrop.plant_design import get_form_factor, blade_dimension, stem_dimension\nfrom archicrop.generator import majors_axes_regression, line_projection, as_leaf, as_plant, cereals as cereals_generator\n# not neccessary to import, but useful to see which functions are used \n\nfrom archicrop.cereals import build_shoot\n\n# def build_shoot(stem_radius, insertion_heights, leaf_lengths, leaf_areas, leaf_azimuths=None, leaf_shapes=None):\n#     \"\"\"create a shoot\n\n#     Args:\n#         stem_radius: (float) the stem radius\n#         insertion_heights: list of each leaf insertion height\n#         leaf_lengths: list of each leaf length (blade length)\n#         leaf_areas: list of each blade area\n#         collar_visible: list of each collar height or True if the collar is visible and False if it is not\n#         leaf_shapes: list of each leaf shape, if it is not known write None\n#         leaf_azimuths: list of each leaf azimuth, if it is not known write None\n\n#     Returns:\n#         shoot: \n\n#     \"\"\"\n#     ranks = range(1, len(leaf_lengths) + 1)\n#     ntop = max(ranks) - np.array(ranks) + 1\n#     if leaf_shapes is None:\n#         a_leaf = parametric_leaf()\n#         leaf_shapes = [a_leaf for r in ranks]\n#     if leaf_azimuths is None:\n#         leaf_azimuths = leaf_azimuth(len(ranks))\n#     leaf_azimuths[1:] = np.diff(leaf_azimuths)\n#     ff = [get_form_factor(leaf) for leaf in leaf_shapes]\n#     blades = blade_dimension(area=leaf_areas, length=leaf_lengths, ntop=ntop)\n#     stem = stem_dimension(h_ins=insertion_heights, d_internode=np.array(stem_radius) * 2, ntop=ntop)\n#     df = blades.merge(stem)\n#     df['leaf_azimuth'] = leaf_azimuths\n#     df['leaf_rank'] = ranks\n#     df['leaf_shape'] = [leaf_shapes[n - 1] for n in df.leaf_rank]\n#     return df, cereals_generator(plant=df)\n\n\n\n\nCode\n# see problems with this function\ndef build_shoot_w_pseudo(nb_phy, plant_height, insertion_heights, leaf_lengths, leaf_areas, \n                pseudostem_dist=1.4, stem_dist=1.2,\n                diam_base=2.5, diam_top=1, pseudostem_height=20, \n                leaf_azimuths=None, leaf_shapes=None, wl=0.1):\n    \"\"\"create a shoot, with pseudostems and stems\n\n    Args:\n        stem_radius: (float) the stem radius\n        insertion_heights: list of each leaf insertion height\n        leaf_lengths: list of each leaf length (blade length)\n        leaf_areas: list of each blade area\n        collar_visible: list of each collar height or True if the collar is visible and False if it is not\n        leaf_shapes: list of each leaf shape, if it is not known write None\n        leaf_azimuths: list of each leaf azimuth, if it is not known write None\n\n    Returns:\n        shoot: \n\n    \"\"\"\n    ranks = range(1, len(leaf_lengths) + 1)\n    ntop = max(ranks) - np.array(ranks) + 1\n\n    nb_phy = int(nb_phy)\n\n    # Lejeune an Bernier formula + col =\n    nb_young_phy = int(round((nb_phy - 1.95) / 1.84 / 1.3))\n\n    # distances between leaves\n    pseudostem = geometric_dist(pseudostem_height, nb_young_phy,\n                                pseudostem_dist)\n    stem = geometric_dist(plant_height - pseudostem_height,\n                          nb_phy - nb_young_phy, stem_dist)\n    internode = pseudostem + stem\n    # stem diameters\n    diameter = ([diam_base] * nb_young_phy +\n                np.linspace(diam_base, diam_top,\n                            nb_phy - nb_young_phy).tolist())\n    \n    if leaf_shapes is None:\n        a_leaf = parametric_leaf()\n        leaf_shapes = [a_leaf for r in ranks]\n    if leaf_azimuths is None:\n        leaf_azimuths = leaf_azimuth(len(ranks))\n    leaf_azimuths[1:] = np.diff(leaf_azimuths)\n    ff = [get_form_factor(leaf) for leaf in leaf_shapes]\n    # blades = blade_dimension(area=leaf_areas, length=leaf_lengths, ntop=ntop)\n    blades = blade_dimension(length=leaf_lengths, form_factor=ff, ntop=ntop, wl=wl)\n    # stem = stem_dimension(h_ins=insertion_heights, d_internode=diameter, ntop=ntop)\n    stem = stem_dimension(internode=internode, d_internode=diameter, ntop=ntop)\n    \n    df = blades.merge(stem)\n    df['leaf_azimuth'] = leaf_azimuths\n    df['leaf_rank'] = ranks\n    df['leaf_shape'] = [leaf_shapes[n - 1] for n in df.leaf_rank]\n    return df, cereals_generator(plant=df)\n\n# shoot, g = build_shoot(3.0, [2,4,6,8], [2,4,6,8], [2,4,6,8])\n# scene, nump = build_scene(g)\n# display_scene(scene)",
    "crumbs": [
      "First chapter: Analyzing accuracy of formalisms in crop model when adding shoot structural variability",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Structural cereal model</span>"
    ]
  },
  {
    "objectID": "structural_cereal_model.html#display-scenes-according-to-different-scenarii",
    "href": "structural_cereal_model.html#display-scenes-according-to-different-scenarii",
    "title": "3  Structural cereal model",
    "section": "3.7 Display scenes according to different scenarii",
    "text": "3.7 Display scenes according to different scenarii\n\n\nCode\n## Imports\n\n# from installed packages\nfrom oawidgets.plantgl import *\n\n# Set nice color for plants\nnice_green=Color3((50,100,0))\n\n\n\n3.7.1 A single cereal\n\n\nCode\n## Imports\n\n# from installed packages\nfrom oawidgets.plantgl import *\n\n# from archicrop\nfrom archicrop.display import display_mtg, build_scene, display_scene\n\n# Enable plotting with PlantGL\n%gui qt\n\n## Code for generating a 3D cereal shoot from descritive parameters\n# Parameters \nstem_radius=1 \nheight=1000                 # from crop model\nnb_phy=17                   # fixed max nb of phytomers\nmax_leaf_length=90 \ninsertion_angle=40\nscurv=0.7\ncurvature=80\nphyllotactic_angle=180\nspiral=True\n\n# pseudostem_dist=1.4\n# stem_dist=1.2 \n# pseudostem_height=150\ndiam_base=2.5\ndiam_top=1.0\n\n\n# Functions calls\n# Lejeune and Bernier formula + col =\nnb_young_phy = int(round((nb_phy - 1.95) / 1.84 / 1.3))\n\n# distances between leaves\n# pseudostem = np.array(geometric_dist(pseudostem_height, \n#                                      nb_young_phy, \n#                                      pseudostem_dist))\n# stem = np.array(geometric_dist(height - pseudostem_height, \n#                                nb_phy - nb_young_phy, \n#                                stem_dist))\n# insertion_heights = np.concatenate((pseudostem, stem), axis=None)\n\n# stem diameters\ndiameter = ([diam_base] * nb_young_phy + np.linspace(diam_base, diam_top, nb_phy - nb_young_phy).tolist())\n\n\ninsertion_heights=np.array(geometric_dist(height, \n                                          nb_phy, \n                                          q=1.25))\n\n\nleaf_lengths=np.array(bell_shaped_dist(max_leaf_length=max_leaf_length, \n                                       nb_phy=nb_phy, \n                                       rmax=0.9, \n                                       skew=0.2)) # plant area --&gt; max leaf length\n# leaf_areas=bell_shaped_dist(plant_area=1, nb_phy=15, rmax=0.7, skew=0.15) # cf blade_dimension\n\na_leaf = parametric_leaf(nb_segment=10, \n                         insertion_angle=insertion_angle, \n                         scurv=scurv, \n                         curvature=curvature, \n                         alpha=-2.3)\n\nleaf_shapes = [a_leaf for l in leaf_lengths] # possible to replace leaf_length by nb_phy or...\n\nleaf_azimuths = leaf_azimuth(size=len(leaf_lengths), \n                             phyllotactic_angle=phyllotactic_angle, \n                             phyllotactic_deviation=15, \n                             plant_orientation=0, \n                             spiral=spiral)\n\nshoot, g_single = build_shoot(stem_diameters=diameter, \n                              insertion_heights=insertion_heights, \n                              leaf_lengths=leaf_lengths, \n                              leaf_areas=None, \n                              leaf_shapes=leaf_shapes, \n                              leaf_azimuths=leaf_azimuths)\n\n# Build and display scene\nscene_single, nump = build_scene(g_single, \n                                 leaf_material=Material(nice_green), \n                                 stem_material=Material(nice_green))\n# display_scene(scene_single) # display in separate window\nPlantGL(scene_single) # display in notebook\n\n\n\n\n\n\n\nCode\nimport matplotlib.pyplot as plt\n\nprint(insertion_heights)\ninternode_lengths=[]\nfor i,h in enumerate(insertion_heights):\n    if i==0:\n        internode_lengths.append(h)\n    else:\n        internode_lengths.append(h-insertion_heights[i-1])\nprint(internode_lengths)\n\nplt.clf()\nplt.plot(range(0,nb_phy), insertion_heights, ls='-')\nplt.scatter(range(0,nb_phy), insertion_heights)\nplt.scatter([0]*nb_phy, insertion_heights)\nplt.scatter(range(0,nb_phy), internode_lengths)\nplt.show()\n\n\n[  4.58621758   5.73277197   7.16596497   8.95745621  11.19682026\n  13.99602532  17.49503166  21.86878957  27.33598696  34.1699837\n  42.71247963  53.39059954  66.73824942  83.42281178 104.27851472\n 130.3481434  162.93517925]\n[4.586217578480434, 1.1465543946201082, 1.433192993275136, 1.7914912415939197, 2.239364051992398, 2.7992050649905007, 3.4990063312381228, 4.373757914047655, 5.467197392559569, 6.833996740699458, 8.542495925874327, 10.67811990734291, 13.34764988417863, 16.684562355223292, 20.85570294402912, 26.069628680036402, 32.58703585004548]\n\n\n\n\n\nLet’s dig into the propreties of the MTG of a cereal shoot.\n\n\nCode\n## Imports\n\n# from installed packages\nfrom oawidgets.mtg import *\n\n\n## Code for exploring the MTG of the generated cereal shoot\n\n# Properties on the MTG: this exclude all the topological properties\nprint(g_single.property_names())\n\n# Retrieve one property for the MTG (dict)\n\nlabels = g_single.property('label')\n# print(labels)\n\nlength = g_single.property('length')\n# print(length)\n\nleaf_lengths=[]\nleaf_ind=[]\ninternode_lengths=[]\ninternode_ind=[]\nfor k,v in length.items():\n    if k%2==0: # could have done it using labels\n        internode_ind.append(k)\n        internode_lengths.append(v)\n    else:\n        leaf_ind.append(k)\n        leaf_lengths.append(v)\n\nwidth = g_single.property('shape_max_width')\n\nleaf_widths=[]\nfor k,v in width.items():\n    leaf_widths.append(v)\n\n\nplt.figure()\nplt.plot(leaf_ind, leaf_lengths, c=\"green\", label=\"Leaf lengths\") # == 'shape_mature_length' for final plant\nplt.plot(leaf_ind, leaf_widths, c=\"purple\", label=\"Leaf widths\")\nplt.plot(internode_ind, internode_lengths, c=\"orange\", label=\"Internode lengths\")\nplt.plot(internode_ind, np.cumsum(internode_lengths), c=\"orange\", label=\"Plant height\", ls='--')\nplt.xlabel(\"Vertices\")\nplt.ylabel(\"Lengths (cm)\")\nplt.title(\"MTG properties\")\nplt.legend()\nplt.show()\n\n\n['edge_type', 'label', 'mature_length', 'length', 'visible_length', 'is_green', 'diameter', 'azimuth', 'shape', 'shape_mature_length', 'srb', 'srt', 'lrolled', 'd_rolled', 'shape_max_width', 'stem_diameter', 'geometry', 'anchor_point', 'color']\n\n\n\n\n\nThe leaf lengths and widths follow the bell shaped curve described before.\nThe first internode in the MTG actually corresponds to the pseudostem, i.e. the about 4 to 8 short first internodes that rapidly lose their leaves. The lengths following internodes follow the geometric model described before.\n\n\n3.7.2 A cereal crop with variability\n\n\nCode\n## Imports\n\n# from installed packages\nfrom random import *\n\n# from archicrop\nfrom archicrop.stand import agronomic_plot\n\n# Enable plotting with PlantGL\n%gui qt\n\n## Code for generating a random cereal crop from descritive parameters with variability \n# Fix a seed\nseed(1)\n\n# Initialize the list of plants\nplants_in_crop=[]\n\n# Fixed parameters for all plants\nlength_plot=5\nwidth_plot=5\nsowing_density=10\nplant_density=10\ninter_row=0.5\nnplants, positions, domain, domain_area, unit = agronomic_plot(length_plot, \n                                                               width_plot, \n                                                               sowing_density, \n                                                               plant_density, \n                                                               inter_row, \n                                                               noise=0.1)\n\n# For loop over all the plants in the crop\nfor n in range(nplants):\n    # Parameters varying among plants\n    height=1000*(1+random()-0.5) \n    nb_phy=15 \n    max_leaf_length=50*(1+random()-0.5)\n    insertion_angle=40*(1+random()-0.5)\n    scurv=0.7*(1+random()-0.5)\n    curvature=70*(1+random()-0.5)\n    phyllotactic_angle=137*(1+random()-0.5)\n    spiral=True\n\n    # Functions calls\n    insertion_heights=np.array(geometric_dist(height, nb_phy, q=1.2)) \n    leaf_lengths=np.array(bell_shaped_dist(max_leaf_length=max_leaf_length, nb_phy=nb_phy, rmax=0.7, skew=0.15)) \n    a_leaf = parametric_leaf(nb_segment=10, insertion_angle=insertion_angle, scurv=scurv, curvature=curvature, alpha=-2.3)\n    leaf_shapes = [a_leaf for l in leaf_lengths]\n    leaf_azimuths = leaf_azimuth(size=len(leaf_lengths), phyllotactic_angle=phyllotactic_angle, phyllotactic_deviation=15, \n                                 plant_orientation=random()*360, spiral=spiral)\n    shoot, g_var = build_shoot(stem_diameters=diameter, insertion_heights=insertion_heights, leaf_lengths=leaf_lengths, \n                               leaf_areas=None, leaf_shapes=leaf_shapes, leaf_azimuths=leaf_azimuths)\n\n    # Fill the list of plants\n    plants_in_crop.append(g_var)\n\n# Build and display scene\nscene_var, nump = build_scene(plants_in_crop, positions, leaf_material=Material(nice_green), stem_material=Material(nice_green))\n# display_scene(scene_var)\nPlantGL(scene_var)\n\n\nValueError: All arrays must be of the same length\n\n\n\n\n3.7.3 A seemingly growing plant\n\n\nCode\n## Inputs\n\n# from installed packages\nfrom openalea.plantgl.all import *\n\n# Enable plotting with PlantGL\n%gui qt\n\n## Code for generating a \"growing\" cereal shoot from descritive parameters\n# Fix a seed\nseed(1)\n\n# Initialize the list of plant MTGs at different stages\ngrowing_plants=[]\n\n# Parameters fixing final plant or unchanged with \"growth\"\nnplants=10\npositions=[(x,0,0) for x in range(-500, 500, 100)]\nfinal_height=1000\nfinal_nb_phy=2*nplants\nheights=geometric_dist(final_height, final_nb_phy, 1.2)\n# insertion_heights=np.array(geometric_dist(height, nb_phy, q=1.2))\nstem_radius=2 \ninsertion_angle=30\nscurv=0.7\ncurvature=100\nphyllotactic_angle=137\nspiral=True\n\n# For loop for generating plants at different stages\nfor n in range(1,nplants+1):\n    # Parameters varying when \"growing\"\n    height=10*heights[2*n-1]\n    nb_phy=2*n \n    max_leaf_length=5*2*n\n    \n    # Functions calls\n    insertion_heights=np.array(geometric_dist(height, nb_phy, q=1.2)) \n    leaf_lengths=np.array(bell_shaped_dist(max_leaf_length=max_leaf_length, nb_phy=nb_phy, rmax=0.7, skew=0.15)) \n    a_leaf = parametric_leaf(nb_segment=10, insertion_angle=insertion_angle, scurv=scurv, curvature=curvature, alpha=-2.3)\n    leaf_shapes = [a_leaf for l in leaf_lengths] \n    leaf_azimuths = leaf_azimuth(size=len(leaf_lengths), phyllotactic_angle=phyllotactic_angle, \n                                 phyllotactic_deviation=15, plant_orientation=0, spiral=spiral)\n    shoot, g_grow = build_shoot(stem_radius=stem_radius, insertion_heights=insertion_heights, leaf_lengths=leaf_lengths, \n                                leaf_areas=None, leaf_shapes=leaf_shapes, leaf_azimuths=leaf_azimuths)\n\n    # Fill the list with MTG of \"growing\" plant\n    growing_plants.append(g_grow)\n\n# Build and display scene\nscene_grow, nump = build_scene(growing_plants[2:], positions[2:], leaf_material=Material(nice_green), stem_material=Material(nice_green))\n# display_scene(scene_grow)\nPlantGL(scene_grow)\n\n\n\n\n3.7.4 An intercrop organized in rows\n\n\nCode\n## Inputs\n\n# from installed packages\nfrom openalea.plantgl.all import Material, Color3, Shape, Scene, Viewer, Translated, AxisRotated\n\n# Enable plotting with PlantGL\n%gui qt\n\n## Code for generating an intercrop from descritive parameters\n\n# Fix a seed\nseed(1)\n\ndef plant(height, nb_phy, max_leaf_length, phyllotactic_angle, spiral):\n    \"\"\" return the MTG of a cereal shoot generative from descriptive parameters \"\"\"\n    stem_radius=1 \n    insertion_angle=30\n    scurv=0.7\n    curvature=100\n    \n    insertion_heights=np.array(geometric_dist(height, nb_phy, q=1.2)) \n    leaf_lengths=np.array(bell_shaped_dist(max_leaf_length=max_leaf_length, nb_phy=nb_phy, rmax=0.7, skew=0.15)) \n    a_leaf = parametric_leaf(nb_segment=10, insertion_angle=insertion_angle, scurv=scurv, curvature=curvature, alpha=-2.3)\n    leaf_shapes = [a_leaf for l in leaf_lengths] \n    leaf_azimuths = leaf_azimuth(size=len(leaf_lengths), phyllotactic_angle=phyllotactic_angle, \n                                 phyllotactic_deviation=15, plant_orientation=random()*360, spiral=spiral)\n    shoot, g = build_shoot(stem_radius=stem_radius, insertion_heights=insertion_heights, leaf_lengths=leaf_lengths, \n                           leaf_areas=None, leaf_shapes=leaf_shapes, leaf_azimuths=leaf_azimuths)\n    \n    return g\n\n\n# Organize the plant mixture in alternate rows\nn_rows = 10\nlen_rows = 10\n\nd_inter = 70\nd_intra = 50\n\ndef plant_in_row(i):\n     if i%(4*d_inter)==0 or i%(4*d_inter)==d_inter: return plant(height=1700, nb_phy=15, max_leaf_length=100, phyllotactic_angle=137, spiral=True)\n     else: return plant(height=900, nb_phy=20, max_leaf_length=40, phyllotactic_angle=60, spiral=True)\n\n\nplants_in_intercrop = [plant_in_row(x) for x in range(0, n_rows*d_inter, d_inter) for y in range(0, len_rows*d_intra, d_intra)]\n\npositions=[(x,y,0) for x in range(0, n_rows*d_inter, d_inter) for y in range(0, len_rows*d_intra, d_intra)]\n\n# Build and display scene\nscene_ic, nump = build_scene(plants_in_intercrop, positions, leaf_material=Material(nice_green), stem_material=Material(nice_green))\n# display_scene(scene_ic)\nPlantGL(scene_ic)\n\n\nTypeError: build_shoot() got an unexpected keyword argument 'stem_radius'",
    "crumbs": [
      "First chapter: Analyzing accuracy of formalisms in crop model when adding shoot structural variability",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Structural cereal model</span>"
    ]
  },
  {
    "objectID": "structural_cereal_model.html#tillering-branching",
    "href": "structural_cereal_model.html#tillering-branching",
    "title": "3  Structural cereal model",
    "section": "3.8 Tillering / Branching",
    "text": "3.8 Tillering / Branching\nIn progress …\nFirst, basipetal tillers, straight, oriented according to a certain angle, appearing according to a certain timing",
    "crumbs": [
      "First chapter: Analyzing accuracy of formalisms in crop model when adding shoot structural variability",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Structural cereal model</span>"
    ]
  },
  {
    "objectID": "structural_cereal_model.html#leaf-senescence",
    "href": "structural_cereal_model.html#leaf-senescence",
    "title": "3  Structural cereal model",
    "section": "3.9 Leaf senescence",
    "text": "3.9 Leaf senescence\nIn progress …\nRate of senescence ? Constant number of leaves on a stem from a certain point or not ?",
    "crumbs": [
      "First chapter: Analyzing accuracy of formalisms in crop model when adding shoot structural variability",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Structural cereal model</span>"
    ]
  },
  {
    "objectID": "structural_cereal_model.html#light-interception-with-caribu",
    "href": "structural_cereal_model.html#light-interception-with-caribu",
    "title": "3  Structural cereal model",
    "section": "3.10 Light interception with Caribu",
    "text": "3.10 Light interception with Caribu\nIn progress …\nWe have to configure Caribu to simulate the same light as in STICS\n\n\nCode\n# #| echo: false\n\n## Imports \nfrom alinea.caribu.CaribuScene import CaribuScene\nfrom alinea.caribu.data_samples import data_path\n\n# ## Code for computing light interception with Caribu\n# sky = str(data_path('Turtle16soc.light'))\n# # opts = map(str, [data_path('par.opt'), data_path('nir.opt')])\n\n# # complete set of files\n# cs = CaribuScene(scene=scene_var, light=sky) # opt=opts, ) #pattern=pattern)\n# raw,agg=cs.run(simplify=True)\n\n# # print(raw.keys())\n\n# scene,values = cs.plot(raw['Ei'],display=False)\n\n# v99 = np.percentile(values, 99)\n# nvalues=np.array(values)\n# nvalues[nvalues&gt;v99]=v99\n# values = nvalues.tolist()\n\n# # PlantGL(scene, group_by_color=False, property=values)\n\n\n\n\nCode\n## Code for computing light interception with Caribu\nsky = str(data_path('Turtle16soc.light'))\n# opts = map(str, [data_path('par.opt'), data_path('nir.opt')])\n\n# complete set of files\ncs = CaribuScene(scene=scene_ic, light=sky) # opt=opts, ) #pattern=pattern)\nraw,agg=cs.run(simplify=True)\n\nscene,values = cs.plot(raw['Ei'],display=False)\n\nv99 = np.percentile(values, 99)\nnvalues=np.array(values)\nnvalues[nvalues&gt;v99]=v99\nvalues = nvalues.tolist()\n\nPlantGL(scene, group_by_color=False, property=values)\n\n\n\n\nCode\n## Imports \nfrom archicrop.light_it import illuminate\n\n## Code for computing light interception with Caribu\n\ncs, raw_ei, agg = illuminate(scene=scene_ic)\n\nscene,values = cs.plot(raw['Ei'],display=False)\n\nv99 = np.percentile(values, 99)\nnvalues=np.array(values)\nnvalues[nvalues&gt;v99]=v99\nvalues = nvalues.tolist()\n\nPlantGL(scene, group_by_color=False, property=values)",
    "crumbs": [
      "First chapter: Analyzing accuracy of formalisms in crop model when adding shoot structural variability",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Structural cereal model</span>"
    ]
  },
  {
    "objectID": "structural_cereal_model.html#next-steps",
    "href": "structural_cereal_model.html#next-steps",
    "title": "3  Structural cereal model",
    "section": "3.11 Next steps",
    "text": "3.11 Next steps\n\nAdapt for different species (parameters for cereals, some functions for legumes)",
    "crumbs": [
      "First chapter: Analyzing accuracy of formalisms in crop model when adding shoot structural variability",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Structural cereal model</span>"
    ]
  },
  {
    "objectID": "dynamic_model.html",
    "href": "dynamic_model.html",
    "title": "4  Dynamic model",
    "section": "",
    "text": "4.1 Conceptual diagram\nThe main stem grows according to the crop model’s plant height. At the end of the growth of an internode, a leaf appears. The appearance of a leaf is triggered by fixed phyllochron (different for tillers?).\nCf Fournier et al, 2005 for leaf elongation\nThe angle of the leaf with its axis is leaf-age dependent. The leaf blade curvature depends on the angle with the axis and the leaf length.\nThe reproductive organs appear from a given thermal time, when the leaves have stopped growing.\nLeaf senescence is constrained by crop model, as it has a direct influence on LAI (green LAI vs. yellow LAI ?).\nThe branching pattern is set (Tillers (Zhu et al., 2015)).",
    "crumbs": [
      "First chapter: Analyzing accuracy of formalisms in crop model when adding shoot structural variability",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Dynamic model</span>"
    ]
  },
  {
    "objectID": "dynamic_model.html#conceptual-diagram",
    "href": "dynamic_model.html#conceptual-diagram",
    "title": "4  Dynamic model",
    "section": "",
    "text": "Conceptual diagram of shoot FSPM (not final version, some errors)",
    "crumbs": [
      "First chapter: Analyzing accuracy of formalisms in crop model when adding shoot structural variability",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Dynamic model</span>"
    ]
  },
  {
    "objectID": "dynamic_model.html#time-dependent-parametrization-of-leaf-area",
    "href": "dynamic_model.html#time-dependent-parametrization-of-leaf-area",
    "title": "4  Dynamic model",
    "section": "4.2 Time-dependent parametrization of leaf area",
    "text": "4.2 Time-dependent parametrization of leaf area\n\\[ \\mathcal{A_normalized} = 2 * |\\int_{0}^{1} \\mathcal{C}(s(u))ds(u)| \\] \\[ \\mathcal{A} = \\mathcal{A_scaled} = 2 * w * |\\int_{0}^{L} \\mathcal{C}(\\frac{s(u)}{L})d\\frac{s(u)}{L}| \\] \\[ \\frac{d\\mathcal{A}}{dt} = 2 * w * |\\int_{ds(t)/L} \\mathcal{C}(\\frac{s(u)}{L})d\\frac{s(u)}{L}| \\]\n\n\\(\\mathcal{A}\\) : final leaf area (or surface), in \\(cm^2\\) (given by crop model)\n\\(\\frac{d\\mathcal{A}}{dt}\\) : gain in area, in \\(cm^2\\), for a given leaf for a given time step \\(dt\\) (given by crop model)\n\n\\(\\mathcal{C}\\) : curve of the evolution of the leaf width along the leaf, from tip to base (literature/expert knowledge/observation)\n\\(s(t)\\) : curvilinear abscissa of the midrib, in \\(cm\\), as a function of thermal time \\(t\\), such that: $ ds(t) = $ (computed from leaf curvature)\n\\(w\\) : final maximal width of the leaf, in \\(cm\\) (to fix/vary within a reasonable range)\n\\(L\\) : final length of the leaf, in \\(cm\\) (to fix/vary within a reasonable range)\n\\(t\\) : thermal time, in \\(^oC.day\\)\n\nThe objective is to find, for each growing leaf, at each time step, and for a given leaf area provided to the leaf \\(\\frac{d\\mathcal{A}}{dt}\\), how much length \\(ds(t)\\) is added to the leaf.\n\\[ \\frac{d\\mathcal{A}}{dt} = 2w |\\int_{s(t-1)/L}^{s(t)/L} \\mathcal{C}(\\frac{s(u)}{L})d\\frac{s(u)}{L}| \\]\nAccording to the Fundamental Theorem of Calculus, \\(\\mathcal{C}\\) being at least \\(C^0\\) on \\([0,L]\\), \\(F\\) being the antiderivative of \\(\\mathcal{C}\\), we can write:\n\\[ \\frac{d\\mathcal{A}}{dt} = 2w (|F(\\frac{s(t)}{L}) - F(\\frac{s(t-1)}{L})|) \\]\n\\[ F(\\frac{s(t)}{L}) = |\\frac{1}{2w} \\frac{d\\mathcal{A}}{dt} + F(\\frac{s(t-1)}{L})| \\]\nKnowing the other variables, we know have to determine \\(s(t)\\) at thermal time \\(t\\).",
    "crumbs": [
      "First chapter: Analyzing accuracy of formalisms in crop model when adding shoot structural variability",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Dynamic model</span>"
    ]
  },
  {
    "objectID": "dynamic_model.html#apparition-and-growth-of-phytomers-stem-and-leaf",
    "href": "dynamic_model.html#apparition-and-growth-of-phytomers-stem-and-leaf",
    "title": "4  Dynamic model",
    "section": "4.3 Apparition and growth of phytomers (stem and leaf)",
    "text": "4.3 Apparition and growth of phytomers (stem and leaf)\nThe height of the plant/canopy (here we consider the height of the main stem) is given by the crop model.\nThe plastochron (i.e. leaf initiation rate, in \\(leaf^{-1}\\)) is the time interval between two successive leaves produced at the SAM.\nThe phyllochron (i.e. leaf emergence rate, in \\(leaf^{-1}\\)) is the time interval between two successive leaves emerging from the top of the former leaf sheath.\nThe time for a leaf to grow is roughly between 1.5 and 2 phyllochrons.\nWe consider a linear (rough approximation of beta function) growth for the leaf.\n\n\\(\\phi\\) : phyllochron, in \\(^oC.day.leaf^{-1}\\) (literature)\ncur_len_int : current length of growing internodes\nfin_len_int : final length of internodes, in \\(cm\\) (literature, bell shaped model too ?)\nheight : plant height, in \\(cm\\) (given by crop model)\n\\([s(t)]\\) : current length of growing leaves, in \\(cm\\) (computed before)\nfin_len_leaf : final length of leaves, in \\(cm\\) (bell shaped model)\nleaf expansion duration, as \\(x * \\phi\\), in \\(^oC.day\\) (literature, cf Clerget et al., 2008, etc)\n\nCf Fournier et al, 2005; Stewart and Dwyer, 1993; Skinner and Nelson, 1995\nFrom crop model:",
    "crumbs": [
      "First chapter: Analyzing accuracy of formalisms in crop model when adding shoot structural variability",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Dynamic model</span>"
    ]
  },
  {
    "objectID": "dynamic_model.html#modifying-the-mtg-of-a-growing-plant",
    "href": "dynamic_model.html#modifying-the-mtg-of-a-growing-plant",
    "title": "4  Dynamic model",
    "section": "4.4 Modifying the MTG of a growing plant",
    "text": "4.4 Modifying the MTG of a growing plant\nThere are several ways to conceive the MTG for a growing plant.\nAt each thermal time step, the turtle visits each element and adds a value to a time series for each (almost) properties of the MTG.\nOR\nAt each thermal time step, the MTG is replicated and the growing elements ar modified, and new elements are added if needed.\n\n\nCode\n## Imports\n\n# from installed packages\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom openalea.plantgl.all import Vector3\nfrom oawidgets.plantgl import *\n\n# from archicrop\nfrom archicrop.cereals_leaf import parametric_leaf\nfrom archicrop.plant_shape import geometric_dist, bell_shaped_dist\nfrom archicrop.plant_design import leaf_azimuth\nfrom archicrop.cereals import build_shoot\nfrom archicrop.display import display_mtg, build_scene, display_scene\n\n# Enable plotting with PlantGL\n%gui qt\n\n# Set nice color for plants\nnice_green=Color3((50,100,0))\n\n## Code for generating a 3D cereal shoot from descritive parameters\n# Parameters \nheight=1000                 # from crop model\nnb_phy=17                   # fixed max nb of phytomers\nmax_leaf_length=70 \ninsertion_angle=40\nscurv=0.7\ncurvature=80\nphyllotactic_angle=180\nspiral=False\n\ndiam_base=2.5\ndiam_top=1.0\n# Lejeune and Bernier formula + col =\nnb_young_phy = int(round((nb_phy - 1.95) / 1.84 / 1.3))\n# stem diameters\ndiameter = ([diam_base] * nb_young_phy + np.linspace(diam_base, diam_top, nb_phy - nb_young_phy).tolist()) \n\n# Functions calls\ninsertion_heights=np.array(geometric_dist(height, \n                                          nb_phy, \n                                          q=1.25)) # further separate stem and pseudo stem, cf simple maize\n\nleaf_lengths=np.array(bell_shaped_dist(max_leaf_length=max_leaf_length, \n                                       nb_phy=nb_phy, \n                                       rmax=0.7, \n                                       skew=0.15)) # plant area --&gt; max leaf length\n# leaf_areas=bell_shaped_dist(plant_area=1, nb_phy=15, rmax=0.7, skew=0.15) # cf blade_dimension\n\na_leaf = parametric_leaf(nb_segment=10, \n                         insertion_angle=insertion_angle, \n                         scurv=scurv, \n                         curvature=curvature, \n                         alpha=-2.3)\n\nleaf_shapes = [a_leaf for l in leaf_lengths] # possible to replace leaf_length by nb_phy or...\n\nleaf_azimuths = leaf_azimuth(size=len(leaf_lengths), \n                             phyllotactic_angle=phyllotactic_angle, \n                             phyllotactic_deviation=0, \n                             plant_orientation=0, \n                             spiral=spiral)\n\nshoot, g = build_shoot(stem_diameters=diameter, \n                              insertion_heights=insertion_heights, \n                              leaf_lengths=leaf_lengths, \n                              leaf_areas=None, \n                              leaf_shapes=leaf_shapes, \n                              leaf_azimuths=leaf_azimuths)\n\n# Build and display scene\nscene, nump = build_scene(g, \n                          leaf_material=Material(nice_green), \n                          stem_material=Material(nice_green))\n# display_scene(scene_single) # display in separate window\nPlantGL(scene) # display in notebook\n\n\n    plant  ntop    L_blade   W_blade     S_blade  form_factor       h_ins  \\\n0       1    17  24.257403  2.425740   44.131620         0.75    4.586218   \n1       1    16  28.117999  2.811800   59.296642         0.75    5.732772   \n2       1    15  32.484958  3.248496   79.145439         0.75    7.165965   \n3       1    14  37.319154  3.731915  104.453946         0.75    8.957456   \n4       1    13  42.533063  4.253306  135.679608         0.75   11.196820   \n5       1    12  47.980052  4.798005  172.656402         0.75   13.996025   \n6       1    11  53.447544  5.344754  214.247996         0.75   17.495032   \n7       1    10  58.657235  5.865723  258.050339         0.75   21.868790   \n8       1     9  63.275562  6.327556  300.284754         0.75   27.335987   \n9       1     8  66.936782  6.693678  336.039957         0.75   34.169984   \n10      1     7  69.279037  6.927904  359.968873         0.75   42.712480   \n11      1     6  69.990783  6.999078  367.403232         0.75   53.390600   \n12      1     5  68.861371  6.886137  355.641631         0.75   66.738249   \n13      1     4  65.826396  6.582640  324.983578         0.75   83.422812   \n14      1     3  60.996918  6.099692  279.046798         0.75  104.278515   \n15      1     2  54.662930  5.466293  224.102695         0.75  130.348143   \n16      1     1  47.266009  4.726601  167.555668         0.75  162.935179   \n\n    L_sheath  W_sheath  L_internode  W_internode  leaf_azimuth  leaf_rank  \\\n0          0      2.50     4.586218         2.50           0.0          1   \n1          0      2.50     1.146554         2.50         180.0          2   \n2          0      2.50     1.433193         2.50        -180.0          3   \n3          0      2.50     1.791491         2.50         180.0          4   \n4          0      2.50     2.239364         2.50        -180.0          5   \n5          0      2.50     2.799205         2.50         180.0          6   \n6          0      2.50     3.499006         2.50        -180.0          7   \n7          0      2.35     4.373758         2.35         180.0          8   \n8          0      2.20     5.467197         2.20        -180.0          9   \n9          0      2.05     6.833997         2.05         180.0         10   \n10         0      1.90     8.542496         1.90        -180.0         11   \n11         0      1.75    10.678120         1.75         180.0         12   \n12         0      1.60    13.347650         1.60        -180.0         13   \n13         0      1.45    16.684562         1.45         180.0         14   \n14         0      1.30    20.855703         1.30        -180.0         15   \n15         0      1.15    26.069629         1.15         180.0         16   \n16         0      1.00    32.587036         1.00        -180.0         17   \n\n                                           leaf_shape  \n0   ([0.006340269189362794, 0.06693716016798343, 0...  \n1   ([0.006340269189362794, 0.06693716016798343, 0...  \n2   ([0.006340269189362794, 0.06693716016798343, 0...  \n3   ([0.006340269189362794, 0.06693716016798343, 0...  \n4   ([0.006340269189362794, 0.06693716016798343, 0...  \n5   ([0.006340269189362794, 0.06693716016798343, 0...  \n6   ([0.006340269189362794, 0.06693716016798343, 0...  \n7   ([0.006340269189362794, 0.06693716016798343, 0...  \n8   ([0.006340269189362794, 0.06693716016798343, 0...  \n9   ([0.006340269189362794, 0.06693716016798343, 0...  \n10  ([0.006340269189362794, 0.06693716016798343, 0...  \n11  ([0.006340269189362794, 0.06693716016798343, 0...  \n12  ([0.006340269189362794, 0.06693716016798343, 0...  \n13  ([0.006340269189362794, 0.06693716016798343, 0...  \n14  ([0.006340269189362794, 0.06693716016798343, 0...  \n15  ([0.006340269189362794, 0.06693716016798343, 0...  \n16  ([0.006340269189362794, 0.06693716016798343, 0...  \n\n\n\n\n\n\n\nCode\nfrom archicrop.plant_shape import compute_leaf_area\n\ncompute_leaf_area(g)\n\n\n(0, [])\n\n\n\n\nCode\nfrom ipywidgets import interact, interactive, IntSlider, fixed\nfrom archicrop.dynamic import grow_plant, grow_plant_and_display\n\ndef grow_plant_and_display_in_NB(g, time):\n    g, scene, nump=grow_plant_and_display(g, time)\n    w=PlantGL(scene, group_by_color=True)\n    w.wireframe=True\n    return w\n\n\n\n\nCode\n# max_time = max(g.property('end_tt').values())\ninteract(grow_plant_and_display_in_NB, g=fixed(g), time=IntSlider(min=20, max=2000, step=100, value=1000))\n\n\n\n\n\n&lt;function __main__.grow_plant_and_display_in_NB(g, time)&gt;\n\n\n\n\nCode\nfrom oawidgets.mtg import plot as MTGw\nMTGw(g, properties='label')\n# g.display()\n\n\nLocal cdn resources have problems on chrome/safari when used in jupyter-notebook. \n\n\n\n        \n        \n\n\n\n\nCode\ng.properties()\n\n\n{'edge_type': {1: '/',\n  2: '/',\n  4: '+',\n  5: '&lt;',\n  6: '+',\n  7: '&lt;',\n  8: '+',\n  9: '&lt;',\n  10: '+',\n  11: '&lt;',\n  12: '+',\n  13: '&lt;',\n  14: '+',\n  15: '&lt;',\n  16: '+',\n  17: '&lt;',\n  18: '+',\n  19: '&lt;',\n  20: '+',\n  21: '&lt;',\n  22: '+',\n  23: '&lt;',\n  24: '+',\n  25: '&lt;',\n  26: '+',\n  27: '&lt;',\n  28: '+',\n  29: '&lt;',\n  30: '+',\n  31: '&lt;',\n  32: '+',\n  33: '&lt;',\n  34: '+',\n  35: '&lt;',\n  36: '+'},\n 'label': {1: 'Plant',\n  2: 'MainAxis',\n  3: 'Stem',\n  4: 'Leaf',\n  5: 'Stem',\n  6: 'Leaf',\n  7: 'Stem',\n  8: 'Leaf',\n  9: 'Stem',\n  10: 'Leaf',\n  11: 'Stem',\n  12: 'Leaf',\n  13: 'Stem',\n  14: 'Leaf',\n  15: 'Stem',\n  16: 'Leaf',\n  17: 'Stem',\n  18: 'Leaf',\n  19: 'Stem',\n  20: 'Leaf',\n  21: 'Stem',\n  22: 'Leaf',\n  23: 'Stem',\n  24: 'Leaf',\n  25: 'Stem',\n  26: 'Leaf',\n  27: 'Stem',\n  28: 'Leaf',\n  29: 'Stem',\n  30: 'Leaf',\n  31: 'Stem',\n  32: 'Leaf',\n  33: 'Stem',\n  34: 'Leaf',\n  35: 'Stem',\n  36: 'Leaf'},\n 'mature_length': {3: 4.586217578480434,\n  5: 1.1465543946201082,\n  7: 1.433192993275136,\n  9: 1.7914912415939197,\n  11: 2.239364051992398,\n  13: 2.7992050649905007,\n  15: 3.4990063312381228,\n  17: 4.373757914047655,\n  19: 5.467197392559569,\n  21: 6.833996740699458,\n  23: 8.542495925874327,\n  25: 10.67811990734291,\n  27: 13.34764988417863,\n  29: 16.684562355223292,\n  31: 20.85570294402912,\n  33: 26.069628680036402,\n  35: 32.58703585004548},\n 'length': {3: 4.586217578480434,\n  4: 24.257403061691754,\n  5: 1.1465543946201082,\n  6: 28.11799942491916,\n  7: 1.433192993275136,\n  8: 32.48495827609186,\n  9: 1.7914912415939197,\n  10: 37.31915424785508,\n  11: 2.239364051992398,\n  12: 42.5330628879143,\n  13: 2.7992050649905007,\n  14: 47.980051622617076,\n  15: 3.4990063312381228,\n  16: 53.44754389058404,\n  17: 4.373757914047655,\n  18: 58.65723469177758,\n  19: 5.467197392559569,\n  20: 63.275561782558235,\n  21: 6.833996740699458,\n  22: 66.93678179123937,\n  23: 8.542495925874327,\n  24: 69.2790370808687,\n  25: 10.67811990734291,\n  26: 69.99078337619086,\n  27: 13.34764988417863,\n  28: 68.86137099896267,\n  29: 16.684562355223292,\n  30: 65.82639573700129,\n  31: 20.85570294402912,\n  32: 60.99691772383348,\n  33: 26.069628680036402,\n  34: 54.66293009876565,\n  35: 32.58703585004548,\n  36: 47.26600870733798},\n 'visible_length': {3: 4.586217578480434,\n  4: 25.257403061691754,\n  5: 1.1465543946201082,\n  6: 29.11799942491916,\n  7: 1.433192993275136,\n  8: 33.48495827609186,\n  9: 1.7914912415939197,\n  10: 38.31915424785508,\n  11: 2.239364051992398,\n  12: 43.5330628879143,\n  13: 2.7992050649905007,\n  14: 48.980051622617076,\n  15: 3.4990063312381228,\n  16: 54.44754389058404,\n  17: 4.373757914047655,\n  18: 59.65723469177758,\n  19: 3.7276345858360695,\n  20: 43.14242848810788,\n  21: 0.38829526935792374,\n  22: 3.8032262381386004,\n  23: 8.542495925874327,\n  24: 70.2790370808687,\n  25: 10.67811990734291,\n  26: 70.99078337619086,\n  27: 13.34764988417863,\n  28: 69.86137099896267,\n  29: 16.684562355223292,\n  30: 66.82639573700129,\n  31: 20.85570294402912,\n  32: 61.99691772383348,\n  33: 26.069628680036402,\n  34: 55.66293009876565,\n  35: 32.58703585004548,\n  36: 48.26600870733798},\n 'is_green': {3: True,\n  4: True,\n  5: True,\n  6: True,\n  7: True,\n  8: True,\n  9: True,\n  10: True,\n  11: True,\n  12: True,\n  13: True,\n  14: True,\n  15: True,\n  16: True,\n  17: True,\n  18: True,\n  19: True,\n  20: True,\n  21: True,\n  22: True,\n  23: True,\n  24: True,\n  25: True,\n  26: True,\n  27: True,\n  28: True,\n  29: True,\n  30: True,\n  31: True,\n  32: True,\n  33: True,\n  34: True,\n  35: True,\n  36: True},\n 'diameter': {3: 2.5,\n  5: 2.5,\n  7: 2.5,\n  9: 2.5,\n  11: 2.5,\n  13: 2.5,\n  15: 2.5,\n  17: 2.35,\n  19: 2.2,\n  21: 2.05,\n  23: 1.9,\n  25: 1.75,\n  27: 1.6,\n  29: 1.45,\n  31: 1.3,\n  33: 1.1500000000000001,\n  35: 1.0},\n 'azimuth': {3: 0.0,\n  5: 180.0,\n  7: -180.0,\n  9: 180.0,\n  11: -180.0,\n  13: 180.0,\n  15: -180.0,\n  17: 180.0,\n  19: -180.0,\n  21: 180.0,\n  23: -180.0,\n  25: 180.0,\n  27: -180.0,\n  29: 180.0,\n  31: -180.0,\n  33: 180.0,\n  35: -180.0},\n 'shape': {4: (array([0.00634027, 0.06693716, 0.12601321, 0.17710481, 0.24849582,\n          0.33409181, 0.43411926, 0.50961433, 0.5962277 , 0.68355511,\n          0.76088377, 0.83712401]),\n   array([-0.00346833,  0.0859332 ,  0.15575262,  0.20645505,  0.26519042,\n           0.31943549,  0.3622023 ,  0.3799512 ,  0.38430736,  0.37000106,\n           0.3398266 ,  0.29160093]),\n   array([0.        , 0.10800285, 0.19946175, 0.27144153, 0.36388892,\n          0.46522599, 0.57401243, 0.65156583, 0.73828868, 0.82678018,\n          0.90978753, 1.        ]),\n   array([0.73783224, 0.88135009, 0.96283256, 0.99638426, 1.00152079,\n          0.96548102, 0.88349353, 0.79021341, 0.64117414, 0.45187775,\n          0.2610025 , 0.        ])),\n  6: (array([0.00634027, 0.06693716, 0.12601321, 0.17710481, 0.24849582,\n          0.33409181, 0.43411926, 0.50961433, 0.5962277 , 0.68355511,\n          0.76088377, 0.83712401]),\n   array([-0.00346833,  0.0859332 ,  0.15575262,  0.20645505,  0.26519042,\n           0.31943549,  0.3622023 ,  0.3799512 ,  0.38430736,  0.37000106,\n           0.3398266 ,  0.29160093]),\n   array([0.        , 0.10800285, 0.19946175, 0.27144153, 0.36388892,\n          0.46522599, 0.57401243, 0.65156583, 0.73828868, 0.82678018,\n          0.90978753, 1.        ]),\n   array([0.73783224, 0.88135009, 0.96283256, 0.99638426, 1.00152079,\n          0.96548102, 0.88349353, 0.79021341, 0.64117414, 0.45187775,\n          0.2610025 , 0.        ])),\n  8: (array([0.00634027, 0.06693716, 0.12601321, 0.17710481, 0.24849582,\n          0.33409181, 0.43411926, 0.50961433, 0.5962277 , 0.68355511,\n          0.76088377, 0.83712401]),\n   array([-0.00346833,  0.0859332 ,  0.15575262,  0.20645505,  0.26519042,\n           0.31943549,  0.3622023 ,  0.3799512 ,  0.38430736,  0.37000106,\n           0.3398266 ,  0.29160093]),\n   array([0.        , 0.10800285, 0.19946175, 0.27144153, 0.36388892,\n          0.46522599, 0.57401243, 0.65156583, 0.73828868, 0.82678018,\n          0.90978753, 1.        ]),\n   array([0.73783224, 0.88135009, 0.96283256, 0.99638426, 1.00152079,\n          0.96548102, 0.88349353, 0.79021341, 0.64117414, 0.45187775,\n          0.2610025 , 0.        ])),\n  10: (array([0.00634027, 0.06693716, 0.12601321, 0.17710481, 0.24849582,\n          0.33409181, 0.43411926, 0.50961433, 0.5962277 , 0.68355511,\n          0.76088377, 0.83712401]),\n   array([-0.00346833,  0.0859332 ,  0.15575262,  0.20645505,  0.26519042,\n           0.31943549,  0.3622023 ,  0.3799512 ,  0.38430736,  0.37000106,\n           0.3398266 ,  0.29160093]),\n   array([0.        , 0.10800285, 0.19946175, 0.27144153, 0.36388892,\n          0.46522599, 0.57401243, 0.65156583, 0.73828868, 0.82678018,\n          0.90978753, 1.        ]),\n   array([0.73783224, 0.88135009, 0.96283256, 0.99638426, 1.00152079,\n          0.96548102, 0.88349353, 0.79021341, 0.64117414, 0.45187775,\n          0.2610025 , 0.        ])),\n  12: (array([0.00634027, 0.06693716, 0.12601321, 0.17710481, 0.24849582,\n          0.33409181, 0.43411926, 0.50961433, 0.5962277 , 0.68355511,\n          0.76088377, 0.83712401]),\n   array([-0.00346833,  0.0859332 ,  0.15575262,  0.20645505,  0.26519042,\n           0.31943549,  0.3622023 ,  0.3799512 ,  0.38430736,  0.37000106,\n           0.3398266 ,  0.29160093]),\n   array([0.        , 0.10800285, 0.19946175, 0.27144153, 0.36388892,\n          0.46522599, 0.57401243, 0.65156583, 0.73828868, 0.82678018,\n          0.90978753, 1.        ]),\n   array([0.73783224, 0.88135009, 0.96283256, 0.99638426, 1.00152079,\n          0.96548102, 0.88349353, 0.79021341, 0.64117414, 0.45187775,\n          0.2610025 , 0.        ])),\n  14: (array([0.00634027, 0.06693716, 0.12601321, 0.17710481, 0.24849582,\n          0.33409181, 0.43411926, 0.50961433, 0.5962277 , 0.68355511,\n          0.76088377, 0.83712401]),\n   array([-0.00346833,  0.0859332 ,  0.15575262,  0.20645505,  0.26519042,\n           0.31943549,  0.3622023 ,  0.3799512 ,  0.38430736,  0.37000106,\n           0.3398266 ,  0.29160093]),\n   array([0.        , 0.10800285, 0.19946175, 0.27144153, 0.36388892,\n          0.46522599, 0.57401243, 0.65156583, 0.73828868, 0.82678018,\n          0.90978753, 1.        ]),\n   array([0.73783224, 0.88135009, 0.96283256, 0.99638426, 1.00152079,\n          0.96548102, 0.88349353, 0.79021341, 0.64117414, 0.45187775,\n          0.2610025 , 0.        ])),\n  16: (array([0.00634027, 0.06693716, 0.12601321, 0.17710481, 0.24849582,\n          0.33409181, 0.43411926, 0.50961433, 0.5962277 , 0.68355511,\n          0.76088377, 0.83712401]),\n   array([-0.00346833,  0.0859332 ,  0.15575262,  0.20645505,  0.26519042,\n           0.31943549,  0.3622023 ,  0.3799512 ,  0.38430736,  0.37000106,\n           0.3398266 ,  0.29160093]),\n   array([0.        , 0.10800285, 0.19946175, 0.27144153, 0.36388892,\n          0.46522599, 0.57401243, 0.65156583, 0.73828868, 0.82678018,\n          0.90978753, 1.        ]),\n   array([0.73783224, 0.88135009, 0.96283256, 0.99638426, 1.00152079,\n          0.96548102, 0.88349353, 0.79021341, 0.64117414, 0.45187775,\n          0.2610025 , 0.        ])),\n  18: (array([0.00634027, 0.06693716, 0.12601321, 0.17710481, 0.24849582,\n          0.33409181, 0.43411926, 0.50961433, 0.5962277 , 0.68355511,\n          0.76088377, 0.83712401]),\n   array([-0.00346833,  0.0859332 ,  0.15575262,  0.20645505,  0.26519042,\n           0.31943549,  0.3622023 ,  0.3799512 ,  0.38430736,  0.37000106,\n           0.3398266 ,  0.29160093]),\n   array([0.        , 0.10800285, 0.19946175, 0.27144153, 0.36388892,\n          0.46522599, 0.57401243, 0.65156583, 0.73828868, 0.82678018,\n          0.90978753, 1.        ]),\n   array([0.73783224, 0.88135009, 0.96283256, 0.99638426, 1.00152079,\n          0.96548102, 0.88349353, 0.79021341, 0.64117414, 0.45187775,\n          0.2610025 , 0.        ])),\n  20: (array([0.00634027, 0.06693716, 0.12601321, 0.17710481, 0.24849582,\n          0.33409181, 0.43411926, 0.50961433, 0.5962277 , 0.68355511,\n          0.76088377, 0.83712401]),\n   array([-0.00346833,  0.0859332 ,  0.15575262,  0.20645505,  0.26519042,\n           0.31943549,  0.3622023 ,  0.3799512 ,  0.38430736,  0.37000106,\n           0.3398266 ,  0.29160093]),\n   array([0.        , 0.10800285, 0.19946175, 0.27144153, 0.36388892,\n          0.46522599, 0.57401243, 0.65156583, 0.73828868, 0.82678018,\n          0.90978753, 1.        ]),\n   array([0.73783224, 0.88135009, 0.96283256, 0.99638426, 1.00152079,\n          0.96548102, 0.88349353, 0.79021341, 0.64117414, 0.45187775,\n          0.2610025 , 0.        ])),\n  22: (array([0.00634027, 0.06693716, 0.12601321, 0.17710481, 0.24849582,\n          0.33409181, 0.43411926, 0.50961433, 0.5962277 , 0.68355511,\n          0.76088377, 0.83712401]),\n   array([-0.00346833,  0.0859332 ,  0.15575262,  0.20645505,  0.26519042,\n           0.31943549,  0.3622023 ,  0.3799512 ,  0.38430736,  0.37000106,\n           0.3398266 ,  0.29160093]),\n   array([0.        , 0.10800285, 0.19946175, 0.27144153, 0.36388892,\n          0.46522599, 0.57401243, 0.65156583, 0.73828868, 0.82678018,\n          0.90978753, 1.        ]),\n   array([0.73783224, 0.88135009, 0.96283256, 0.99638426, 1.00152079,\n          0.96548102, 0.88349353, 0.79021341, 0.64117414, 0.45187775,\n          0.2610025 , 0.        ])),\n  24: (array([0.00634027, 0.06693716, 0.12601321, 0.17710481, 0.24849582,\n          0.33409181, 0.43411926, 0.50961433, 0.5962277 , 0.68355511,\n          0.76088377, 0.83712401]),\n   array([-0.00346833,  0.0859332 ,  0.15575262,  0.20645505,  0.26519042,\n           0.31943549,  0.3622023 ,  0.3799512 ,  0.38430736,  0.37000106,\n           0.3398266 ,  0.29160093]),\n   array([0.        , 0.10800285, 0.19946175, 0.27144153, 0.36388892,\n          0.46522599, 0.57401243, 0.65156583, 0.73828868, 0.82678018,\n          0.90978753, 1.        ]),\n   array([0.73783224, 0.88135009, 0.96283256, 0.99638426, 1.00152079,\n          0.96548102, 0.88349353, 0.79021341, 0.64117414, 0.45187775,\n          0.2610025 , 0.        ])),\n  26: (array([0.00634027, 0.06693716, 0.12601321, 0.17710481, 0.24849582,\n          0.33409181, 0.43411926, 0.50961433, 0.5962277 , 0.68355511,\n          0.76088377, 0.83712401]),\n   array([-0.00346833,  0.0859332 ,  0.15575262,  0.20645505,  0.26519042,\n           0.31943549,  0.3622023 ,  0.3799512 ,  0.38430736,  0.37000106,\n           0.3398266 ,  0.29160093]),\n   array([0.        , 0.10800285, 0.19946175, 0.27144153, 0.36388892,\n          0.46522599, 0.57401243, 0.65156583, 0.73828868, 0.82678018,\n          0.90978753, 1.        ]),\n   array([0.73783224, 0.88135009, 0.96283256, 0.99638426, 1.00152079,\n          0.96548102, 0.88349353, 0.79021341, 0.64117414, 0.45187775,\n          0.2610025 , 0.        ])),\n  28: (array([0.00634027, 0.06693716, 0.12601321, 0.17710481, 0.24849582,\n          0.33409181, 0.43411926, 0.50961433, 0.5962277 , 0.68355511,\n          0.76088377, 0.83712401]),\n   array([-0.00346833,  0.0859332 ,  0.15575262,  0.20645505,  0.26519042,\n           0.31943549,  0.3622023 ,  0.3799512 ,  0.38430736,  0.37000106,\n           0.3398266 ,  0.29160093]),\n   array([0.        , 0.10800285, 0.19946175, 0.27144153, 0.36388892,\n          0.46522599, 0.57401243, 0.65156583, 0.73828868, 0.82678018,\n          0.90978753, 1.        ]),\n   array([0.73783224, 0.88135009, 0.96283256, 0.99638426, 1.00152079,\n          0.96548102, 0.88349353, 0.79021341, 0.64117414, 0.45187775,\n          0.2610025 , 0.        ])),\n  30: (array([0.00634027, 0.06693716, 0.12601321, 0.17710481, 0.24849582,\n          0.33409181, 0.43411926, 0.50961433, 0.5962277 , 0.68355511,\n          0.76088377, 0.83712401]),\n   array([-0.00346833,  0.0859332 ,  0.15575262,  0.20645505,  0.26519042,\n           0.31943549,  0.3622023 ,  0.3799512 ,  0.38430736,  0.37000106,\n           0.3398266 ,  0.29160093]),\n   array([0.        , 0.10800285, 0.19946175, 0.27144153, 0.36388892,\n          0.46522599, 0.57401243, 0.65156583, 0.73828868, 0.82678018,\n          0.90978753, 1.        ]),\n   array([0.73783224, 0.88135009, 0.96283256, 0.99638426, 1.00152079,\n          0.96548102, 0.88349353, 0.79021341, 0.64117414, 0.45187775,\n          0.2610025 , 0.        ])),\n  32: (array([0.00634027, 0.06693716, 0.12601321, 0.17710481, 0.24849582,\n          0.33409181, 0.43411926, 0.50961433, 0.5962277 , 0.68355511,\n          0.76088377, 0.83712401]),\n   array([-0.00346833,  0.0859332 ,  0.15575262,  0.20645505,  0.26519042,\n           0.31943549,  0.3622023 ,  0.3799512 ,  0.38430736,  0.37000106,\n           0.3398266 ,  0.29160093]),\n   array([0.        , 0.10800285, 0.19946175, 0.27144153, 0.36388892,\n          0.46522599, 0.57401243, 0.65156583, 0.73828868, 0.82678018,\n          0.90978753, 1.        ]),\n   array([0.73783224, 0.88135009, 0.96283256, 0.99638426, 1.00152079,\n          0.96548102, 0.88349353, 0.79021341, 0.64117414, 0.45187775,\n          0.2610025 , 0.        ])),\n  34: (array([0.00634027, 0.06693716, 0.12601321, 0.17710481, 0.24849582,\n          0.33409181, 0.43411926, 0.50961433, 0.5962277 , 0.68355511,\n          0.76088377, 0.83712401]),\n   array([-0.00346833,  0.0859332 ,  0.15575262,  0.20645505,  0.26519042,\n           0.31943549,  0.3622023 ,  0.3799512 ,  0.38430736,  0.37000106,\n           0.3398266 ,  0.29160093]),\n   array([0.        , 0.10800285, 0.19946175, 0.27144153, 0.36388892,\n          0.46522599, 0.57401243, 0.65156583, 0.73828868, 0.82678018,\n          0.90978753, 1.        ]),\n   array([0.73783224, 0.88135009, 0.96283256, 0.99638426, 1.00152079,\n          0.96548102, 0.88349353, 0.79021341, 0.64117414, 0.45187775,\n          0.2610025 , 0.        ])),\n  36: (array([0.00634027, 0.06693716, 0.12601321, 0.17710481, 0.24849582,\n          0.33409181, 0.43411926, 0.50961433, 0.5962277 , 0.68355511,\n          0.76088377, 0.83712401]),\n   array([-0.00346833,  0.0859332 ,  0.15575262,  0.20645505,  0.26519042,\n           0.31943549,  0.3622023 ,  0.3799512 ,  0.38430736,  0.37000106,\n           0.3398266 ,  0.29160093]),\n   array([0.        , 0.10800285, 0.19946175, 0.27144153, 0.36388892,\n          0.46522599, 0.57401243, 0.65156583, 0.73828868, 0.82678018,\n          0.90978753, 1.        ]),\n   array([0.73783224, 0.88135009, 0.96283256, 0.99638426, 1.00152079,\n          0.96548102, 0.88349353, 0.79021341, 0.64117414, 0.45187775,\n          0.2610025 , 0.        ]))},\n 'shape_mature_length': {4: 24.257403061691754,\n  6: 28.11799942491916,\n  8: 32.48495827609186,\n  10: 37.31915424785508,\n  12: 42.5330628879143,\n  14: 47.980051622617076,\n  16: 53.44754389058404,\n  18: 58.65723469177758,\n  20: 63.275561782558235,\n  22: 66.93678179123937,\n  24: 69.2790370808687,\n  26: 69.99078337619086,\n  28: 68.86137099896267,\n  30: 65.82639573700129,\n  32: 60.99691772383348,\n  34: 54.66293009876565,\n  36: 47.26600870733798},\n 'leaf_area': {4: 44.13162024730294,\n  6: 59.296641874481566,\n  8: 79.14543856495717,\n  10: 104.45394553314,\n  12: 135.67960789704546,\n  14: 172.65640152817497,\n  16: 214.24799609519312,\n  18: 258.0503386264707,\n  20: 300.28475391737584,\n  22: 336.0399567425996,\n  24: 359.9688734139286,\n  26: 367.4032318209657,\n  28: 355.64163118925825,\n  30: 324.98357817932265,\n  32: 279.0467978856083,\n  34: 224.10269452369047,\n  36: 167.55566843416125},\n 'form_factor': {4: 0.75,\n  6: 0.75,\n  8: 0.75,\n  10: 0.75,\n  12: 0.75,\n  14: 0.75,\n  16: 0.75,\n  18: 0.75,\n  20: 0.75,\n  22: 0.75,\n  24: 0.75,\n  26: 0.75,\n  28: 0.75,\n  30: 0.75,\n  32: 0.75,\n  34: 0.75,\n  36: 0.75},\n 'srb': {4: 0,\n  6: 0,\n  8: 0,\n  10: 0,\n  12: 0,\n  14: 0,\n  16: 0,\n  18: 0,\n  20: 0,\n  22: 0,\n  24: 0,\n  26: 0,\n  28: 0,\n  30: 0,\n  32: 0,\n  34: 0,\n  36: 0},\n 'srt': {4: 1,\n  6: 1,\n  8: 1,\n  10: 1,\n  12: 1,\n  14: 1,\n  16: 1,\n  18: 1,\n  20: 1,\n  22: 1,\n  24: 1,\n  26: 1,\n  28: 1,\n  30: 1,\n  32: 1,\n  34: 1,\n  36: 1},\n 'lrolled': {4: 0,\n  6: 0,\n  8: 0,\n  10: 0,\n  12: 0,\n  14: 0,\n  16: 0,\n  18: 0,\n  20: 0,\n  22: 0,\n  24: 0,\n  26: 0,\n  28: 0,\n  30: 0,\n  32: 0,\n  34: 0,\n  36: 0},\n 'd_rolled': {4: 0,\n  6: 0,\n  8: 0,\n  10: 0,\n  12: 0,\n  14: 0,\n  16: 0,\n  18: 0,\n  20: 0,\n  22: 0,\n  24: 0,\n  26: 0,\n  28: 0,\n  30: 0,\n  32: 0,\n  34: 0,\n  36: 0},\n 'shape_max_width': {4: 2.4257403061691756,\n  6: 2.8117999424919162,\n  8: 3.248495827609186,\n  10: 3.7319154247855084,\n  12: 4.25330628879143,\n  14: 4.798005162261708,\n  16: 5.344754389058405,\n  18: 5.865723469177759,\n  20: 6.327556178255824,\n  22: 6.693678179123937,\n  24: 6.927903708086871,\n  26: 6.999078337619086,\n  28: 6.886137099896267,\n  30: 6.5826395737001295,\n  32: 6.099691772383348,\n  34: 5.466293009876566,\n  36: 4.726600870733798},\n 'stem_diameter': {4: 2.5,\n  6: 2.5,\n  8: 2.5,\n  10: 2.5,\n  12: 2.5,\n  14: 2.5,\n  16: 2.5,\n  18: 2.35,\n  20: 2.2,\n  22: 2.05,\n  24: 1.9,\n  26: 1.75,\n  28: 1.6,\n  30: 1.45,\n  32: 1.3,\n  34: 1.1500000000000001,\n  36: 1.0},\n 'geometry': {3: &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet at 0x2420c32b290&gt;,\n  4: &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet at 0x2420c32b220&gt;,\n  5: &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet at 0x2420c32b1b0&gt;,\n  6: &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet at 0x2420c32b140&gt;,\n  7: &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet at 0x2420c32b0d0&gt;,\n  8: &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet at 0x2420c32b060&gt;,\n  9: &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet at 0x2420c32aff0&gt;,\n  10: &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet at 0x2420c32af80&gt;,\n  11: &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet at 0x2420c32af10&gt;,\n  12: &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet at 0x2420c32aea0&gt;,\n  13: &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet at 0x2420c32ae30&gt;,\n  14: &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet at 0x2420c32adc0&gt;,\n  15: &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet at 0x2420c32ad50&gt;,\n  16: &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet at 0x2420c32ace0&gt;,\n  17: &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet at 0x2420c32ac70&gt;,\n  18: &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet at 0x2420c32ac00&gt;,\n  19: &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet at 0x2420c32ab90&gt;,\n  20: &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet at 0x2420c32ab20&gt;,\n  21: &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet at 0x2420c32aab0&gt;,\n  22: &lt;openalea.plantgl.scenegraph._pglsg.TriangleSet at 0x2420c32aa40&gt;},\n 'anchor_point': {3: Vector3(0,0,0),\n  4: Vector3(0,0,4.58622),\n  5: Vector3(0,0,4.58622),\n  6: Vector3(0,0,5.73277),\n  7: Vector3(0,0,5.73277),\n  8: Vector3(0,0,7.16596),\n  9: Vector3(0,0,7.16596),\n  10: Vector3(0,0,8.95746),\n  11: Vector3(0,0,8.95746),\n  12: Vector3(0,0,11.1968),\n  13: Vector3(0,0,11.1968),\n  14: Vector3(0,0,13.996),\n  15: Vector3(0,0,13.996),\n  16: Vector3(0,0,17.495),\n  17: Vector3(0,0,17.495),\n  18: Vector3(0,0,21.8688),\n  19: Vector3(0,0,21.8688),\n  20: Vector3(0,0,25.5964),\n  21: Vector3(0,0,25.5964),\n  22: Vector3(0,0,25.9847),\n  23: Vector3(0,0,34.17),\n  24: Vector3(0,0,42.7125),\n  25: Vector3(0,0,42.7125),\n  26: Vector3(0,0,53.3906),\n  27: Vector3(0,0,53.3906),\n  28: Vector3(0,0,66.7382),\n  29: Vector3(0,0,66.7382),\n  30: Vector3(0,0,83.4228),\n  31: Vector3(0,0,83.4228),\n  32: Vector3(0,0,104.279),\n  33: Vector3(0,0,104.279),\n  34: Vector3(0,0,130.348),\n  35: Vector3(0,0,130.348),\n  36: Vector3(0,0,162.935)},\n 'color': {},\n 'start_tt': {3: 0,\n  4: 0,\n  5: 110.0,\n  6: 110.0,\n  7: 220.0,\n  8: 220.0,\n  9: 330.0,\n  10: 330.0,\n  11: 440.0,\n  12: 440.0,\n  13: 550.0,\n  14: 550.0,\n  15: 660.0,\n  16: 660.0,\n  17: 770.0,\n  18: 770.0,\n  19: 880.0,\n  20: 880.0,\n  21: 990.0,\n  22: 990.0,\n  23: 1100.0,\n  24: 1100.0,\n  25: 1210.0,\n  26: 1210.0,\n  27: 1320.0,\n  28: 1320.0,\n  29: 1430.0,\n  30: 1430.0,\n  31: 1540.0,\n  32: 1540.0,\n  33: 1650.0,\n  34: 1650.0,\n  35: 1760.0,\n  36: 1760.0},\n 'end_tt': {3: 176.0,\n  4: 176.0,\n  5: 286.0,\n  6: 286.0,\n  7: 396.0,\n  8: 396.0,\n  9: 506.0,\n  10: 506.0,\n  11: 616.0,\n  12: 616.0,\n  13: 726.0,\n  14: 726.0,\n  15: 836.0,\n  16: 836.0,\n  17: 946.0,\n  18: 946.0,\n  19: 1056.0,\n  20: 1056.0,\n  21: 1166.0,\n  22: 1166.0,\n  23: 1276.0,\n  24: 1276.0,\n  25: 1386.0,\n  26: 1386.0,\n  27: 1496.0,\n  28: 1496.0,\n  29: 1606.0,\n  30: 1606.0,\n  31: 1716.0,\n  32: 1716.0,\n  33: 1826.0,\n  34: 1826.0,\n  35: 1936.0,\n  36: 1936.0},\n '_plant_translation': {},\n 'position': {}}\n\n\n\n\nCode\n## Code for generating a growing cereal shoot from descritive parameters\n\n# Initialize the list of plant MTGs at different stages\ngrowing_plants=[]\n# positions=[(x,0,0) for x in range(0, 3600, 100)]\npositions=[(x,0,0) for x in range(0, 600, 100)]\n\n# For loop for generating plants at different stages\nfor time in range(0,1800,50):\n# for time in range(1000,1300,50):\n    gg=grow_plant(g, time=time).sub_mtg(grow_plant(g, time=time).root) \n    # Fill the list with MTG of growing plant\n    growing_plants.append(gg)\n\n    print(compute_leaf_area(gg))\n    \n\n    # i=0\n    # for v in g.vertices():\n    #     n=gg.node(v)\n    #     if n.label is not None and n.label.startswith('Stem'):\n    #         print(n.label, i, n.visible_length)\n    #     i+=1\n    # print('')\n\n# Build and display scene\n# scene_grow, nump = build_scene(growing_plants, positions, leaf_material=Material(nice_green), stem_material=Material(nice_green))\n# # display_scene(scene_grow)\n# PlantGL(scene_grow)\n\n\n(6225.081553917091, [0.0, 90.72060237418295, 109.42356888758815, 201.67537532632647, 245.077108970223, 288.67084540115076, 327.7876562446977, 356.77089567182355, 579.7774334129538, 606.9865794382832, 601.8457357316205, 562.1067475553564, 491.6970230418619, 627.4649058939882, 504.04024269510165, 374.68587154744324, 256.3509617244893])\n(6237.4173225280265, [12.33576861093561, 90.72060237418295, 109.42356888758815, 201.67537532632647, 245.077108970223, 288.67084540115076, 327.7876562446977, 356.77089567182355, 579.7774334129538, 606.9865794382832, 601.8457357316205, 562.1067475553564, 491.6970230418619, 627.4649058939882, 504.04024269510165, 374.68587154744324, 256.3509617244893])\n(6266.1498344368965, [41.06828051980549, 90.72060237418295, 109.42356888758815, 201.67537532632647, 245.077108970223, 288.67084540115076, 327.7876562446977, 356.77089567182355, 579.7774334129538, 606.9865794382832, 601.8457357316205, 562.1067475553564, 491.6970230418619, 627.4649058939882, 504.04024269510165, 374.68587154744324, 256.3509617244893])\n(6219.109907855692, [73.7853448407042, 10.96361147207996, 109.42356888758815, 201.67537532632647, 245.077108970223, 288.67084540115076, 327.7876562446977, 356.77089567182355, 579.7774334129538, 606.9865794382832, 601.8457357316205, 562.1067475553564, 491.6970230418619, 627.4649058939882, 504.04024269510165, 374.68587154744324, 256.3509617244893])\n(6254.643776678205, [73.7853448407042, 46.49748029459225, 109.42356888758815, 201.67537532632647, 245.077108970223, 288.67084540115076, 327.7876562446977, 356.77089567182355, 579.7774334129538, 606.9865794382832, 601.8457357316205, 562.1067475553564, 491.6970230418619, 627.4649058939882, 504.04024269510165, 374.68587154744324, 256.3509617244893])\n(6197.941816237055, [73.7853448407042, 90.72060237418295, 8.498486366847741, 201.67537532632647, 245.077108970223, 288.67084540115076, 327.7876562446977, 356.77089567182355, 579.7774334129538, 606.9865794382832, 601.8457357316205, 562.1067475553564, 491.6970230418619, 627.4649058939882, 504.04024269510165, 374.68587154744324, 256.3509617244893])\n(6240.37942593302, [73.7853448407042, 90.72060237418295, 50.93609606281261, 201.67537532632647, 245.077108970223, 288.67084540115076, 327.7876562446977, 356.77089567182355, 579.7774334129538, 606.9865794382832, 601.8457357316205, 562.1067475553564, 491.6970230418619, 627.4649058939882, 504.04024269510165, 374.68587154744324, 256.3509617244893])\n(6102.333124580842, [73.7853448407042, 90.72060237418295, 109.42356888758815, 5.141601149373934, 245.077108970223, 288.67084540115076, 327.7876562446977, 356.77089567182355, 579.7774334129538, 606.9865794382832, 601.8457357316205, 562.1067475553564, 491.6970230418619, 627.4649058939882, 504.04024269510165, 374.68587154744324, 256.3509617244893])\n(6150.579297744193, [73.7853448407042, 90.72060237418295, 109.42356888758815, 53.387774312724446, 245.077108970223, 288.67084540115076, 327.7876562446977, 356.77089567182355, 579.7774334129538, 606.9865794382832, 601.8457357316205, 562.1067475553564, 491.6970230418619, 627.4649058939882, 504.04024269510165, 374.68587154744324, 256.3509617244893])\n(5982.526681342746, [73.7853448407042, 90.72060237418295, 109.42356888758815, 128.69172601161287, 1.720540869887648, 288.67084540115076, 327.7876562446977, 356.77089567182355, 579.7774334129538, 606.9865794382832, 601.8457357316205, 562.1067475553564, 491.6970230418619, 627.4649058939882, 504.04024269510165, 374.68587154744324, 256.3509617244893])\n(6106.570760147854, [73.7853448407042, 90.72060237418295, 109.42356888758815, 201.67537532632647, 52.78097036028274, 288.67084540115076, 327.7876562446977, 356.77089567182355, 579.7774334129538, 606.9865794382832, 601.8457357316205, 562.1067475553564, 491.6970230418619, 627.4649058939882, 504.04024269510165, 374.68587154744324, 256.3509617244893])\n(5911.738910996361, [73.7853448407042, 90.72060237418295, 109.42356888758815, 201.67537532632647, 146.61996660993972, 0.0, 327.7876562446977, 356.77089567182355, 579.7774334129538, 606.9865794382832, 601.8457357316205, 562.1067475553564, 491.6970230418619, 627.4649058939882, 504.04024269510165, 374.68587154744324, 256.3509617244893])\n(6058.457354584952, [73.7853448407042, 90.72060237418295, 109.42356888758815, 201.67537532632647, 245.077108970223, 48.26130122830735, 327.7876562446977, 356.77089567182355, 579.7774334129538, 606.9865794382832, 601.8457357316205, 562.1067475553564, 491.6970230418619, 627.4649058939882, 504.04024269510165, 374.68587154744324, 256.3509617244893])\n(6170.8677325690705, [73.7853448407042, 90.72060237418295, 109.42356888758815, 201.67537532632647, 245.077108970223, 160.67167921242603, 327.7876562446977, 356.77089567182355, 579.7774334129538, 606.9865794382832, 601.8457357316205, 562.1067475553564, 491.6970230418619, 627.4649058939882, 504.04024269510165, 374.68587154744324, 256.3509617244893])\n(6010.692477151773, [73.7853448407042, 90.72060237418295, 109.42356888758815, 201.67537532632647, 245.077108970223, 288.67084540115076, 39.61323463867638, 356.77089567182355, 579.7774334129538, 606.9865794382832, 601.8457357316205, 562.1067475553564, 491.6970230418619, 627.4649058939882, 504.04024269510165, 374.68587154744324, 256.3509617244893])\n(6139.08187574281, [73.7853448407042, 90.72060237418295, 109.42356888758815, 201.67537532632647, 245.077108970223, 288.67084540115076, 168.00263322971213, 356.77089567182355, 579.7774334129538, 606.9865794382832, 601.8457357316205, 562.1067475553564, 491.6970230418619, 627.4649058939882, 504.04024269510165, 374.68587154744324, 256.3509617244893])\n(5969.8049566850805, [73.7853448407042, 90.72060237418295, 109.42356888758815, 201.67537532632647, 245.077108970223, 288.67084540115076, 327.7876562446977, 27.70895359910866, 579.7774334129538, 606.9865794382832, 601.8457357316205, 562.1067475553564, 491.6970230418619, 627.4649058939882, 504.04024269510165, 374.68587154744324, 256.3509617244893])\n(6108.1709794288145, [73.7853448407042, 90.72060237418295, 109.42356888758815, 201.67537532632647, 245.077108970223, 288.67084540115076, 327.7876562446977, 166.0749763428435, 579.7774334129538, 606.9865794382832, 601.8457357316205, 562.1067475553564, 491.6970230418619, 627.4649058939882, 504.04024269510165, 374.68587154744324, 256.3509617244893])\n(5733.870567465979, [73.7853448407042, 90.72060237418295, 109.42356888758815, 201.67537532632647, 245.077108970223, 288.67084540115076, 327.7876562446977, 356.77089567182355, 14.781102121137222, 606.9865794382832, 601.8457357316205, 562.1067475553564, 491.6970230418619, 627.4649058939882, 504.04024269510165, 374.68587154744324, 256.3509617244893])\n(5872.568920715022, [73.7853448407042, 90.72060237418295, 109.42356888758815, 201.67537532632647, 245.077108970223, 288.67084540115076, 327.7876562446977, 356.77089567182355, 153.4794553701808, 606.9865794382832, 601.8457357316205, 562.1067475553564, 491.6970230418619, 627.4649058939882, 504.04024269510165, 374.68587154744324, 256.3509617244893])\n(5486.327831450067, [73.7853448407042, 90.72060237418295, 109.42356888758815, 201.67537532632647, 245.077108970223, 288.67084540115076, 327.7876562446977, 356.77089567182355, 369.9636531617556, 4.261292381753028, 601.8457357316205, 562.1067475553564, 491.6970230418619, 627.4649058939882, 504.04024269510165, 374.68587154744324, 256.3509617244893])\n(5822.603832392754, [73.7853448407042, 90.72060237418295, 109.42356888758815, 201.67537532632647, 245.077108970223, 288.67084540115076, 327.7876562446977, 356.77089567182355, 579.7774334129538, 130.72351307324254, 601.8457357316205, 562.1067475553564, 491.6970230418619, 627.4649058939882, 504.04024269510165, 374.68587154744324, 256.3509617244893])\n(5453.170709943681, [73.7853448407042, 90.72060237418295, 109.42356888758815, 201.67537532632647, 245.077108970223, 288.67084540115076, 327.7876562446977, 356.77089567182355, 579.7774334129538, 363.1361263557899, 0.0, 562.1067475553564, 491.6970230418619, 627.4649058939882, 504.04024269510165, 374.68587154744324, 256.3509617244893])\n(5797.640462854505, [73.7853448407042, 90.72060237418295, 109.42356888758815, 201.67537532632647, 245.077108970223, 288.67084540115076, 327.7876562446977, 356.77089567182355, 579.7774334129538, 606.9865794382832, 100.61929982833047, 562.1067475553564, 491.6970230418619, 627.4649058939882, 504.04024269510165, 374.68587154744324, 256.3509617244893])\n(6032.003259512085, [73.7853448407042, 90.72060237418295, 109.42356888758815, 201.67537532632647, 245.077108970223, 288.67084540115076, 327.7876562446977, 356.77089567182355, 579.7774334129538, 606.9865794382832, 334.98209648590984, 562.1067475553564, 491.6970230418619, 627.4649058939882, 504.04024269510165, 374.68587154744324, 256.3509617244893])\n(5804.690916924352, [73.7853448407042, 90.72060237418295, 109.42356888758815, 201.67537532632647, 245.077108970223, 288.67084540115076, 327.7876562446977, 356.77089567182355, 579.7774334129538, 606.9865794382832, 601.8457357316205, 67.93076572191316, 491.6970230418619, 627.4649058939882, 504.04024269510165, 374.68587154744324, 256.3509617244893])\n(6024.85951048701, [73.7853448407042, 90.72060237418295, 109.42356888758815, 201.67537532632647, 245.077108970223, 288.67084540115076, 327.7876562446977, 356.77089567182355, 579.7774334129538, 606.9865794382832, 601.8457357316205, 288.0993592845718, 491.6970230418619, 627.4649058939882, 504.04024269510165, 374.68587154744324, 256.3509617244893])\n(5845.357996332194, [73.7853448407042, 90.72060237418295, 109.42356888758815, 201.67537532632647, 245.077108970223, 288.67084540115076, 327.7876562446977, 356.77089567182355, 579.7774334129538, 606.9865794382832, 601.8457357316205, 562.1067475553564, 38.18812061626027, 627.4649058939882, 504.04024269510165, 374.68587154744324, 256.3509617244893])\n(6036.052255024803, [73.7853448407042, 90.72060237418295, 109.42356888758815, 201.67537532632647, 245.077108970223, 288.67084540115076, 327.7876562446977, 356.77089567182355, 579.7774334129538, 606.9865794382832, 601.8457357316205, 562.1067475553564, 228.88237930887044, 627.4649058939882, 504.04024269510165, 374.68587154744324, 256.3509617244893])\n(5687.398860483942, [73.7853448407042, 90.72060237418295, 109.42356888758815, 201.67537532632647, 245.077108970223, 288.67084540115076, 327.7876562446977, 356.77089567182355, 579.7774334129538, 606.9865794382832, 601.8457357316205, 562.1067475553564, 491.6970230418619, 15.996867620135223, 504.04024269510165, 374.68587154744324, 256.3509617244893])\n(5837.505339545667, [73.7853448407042, 90.72060237418295, 109.42356888758815, 201.67537532632647, 245.077108970223, 288.67084540115076, 327.7876562446977, 356.77089567182355, 579.7774334129538, 606.9865794382832, 601.8457357316205, 562.1067475553564, 491.6970230418619, 166.1033466818604, 504.04024269510165, 374.68587154744324, 256.3509617244893])\n(5571.293977901899, [73.7853448407042, 90.72060237418295, 109.42356888758815, 201.67537532632647, 245.077108970223, 288.67084540115076, 327.7876562446977, 356.77089567182355, 579.7774334129538, 606.9865794382832, 601.8457357316205, 562.1067475553564, 491.6970230418619, 400.3936604583109, 3.5385672748831882, 374.68587154744324, 256.3509617244893])\n(5903.379157036223, [73.7853448407042, 90.72060237418295, 109.42356888758815, 201.67537532632647, 245.077108970223, 288.67084540115076, 327.7876562446977, 356.77089567182355, 579.7774334129538, 606.9865794382832, 601.8457357316205, 562.1067475553564, 491.6970230418619, 627.4649058939882, 108.55250097352925, 374.68587154744324, 256.3509617244893])\n(5721.688178576443, [73.7853448407042, 90.72060237418295, 109.42356888758815, 201.67537532632647, 245.077108970223, 288.67084540115076, 327.7876562446977, 356.77089567182355, 579.7774334129538, 606.9865794382832, 601.8457357316205, 562.1067475553564, 491.6970230418619, 627.4649058939882, 301.54739406119285, 0.0, 256.3509617244893])\n(5986.822710639149, [73.7853448407042, 90.72060237418295, 109.42356888758815, 201.67537532632647, 245.077108970223, 288.67084540115076, 327.7876562446977, 356.77089567182355, 579.7774334129538, 606.9865794382832, 601.8457357316205, 562.1067475553564, 491.6970230418619, 627.4649058939882, 504.04024269510165, 62.641683428796796, 256.3509617244893])\n(6132.727921078488, [73.7853448407042, 90.72060237418295, 109.42356888758815, 201.67537532632647, 245.077108970223, 288.67084540115076, 327.7876562446977, 356.77089567182355, 579.7774334129538, 606.9865794382832, 601.8457357316205, 562.1067475553564, 491.6970230418619, 627.4649058939882, 504.04024269510165, 208.54689386813664, 256.3509617244893])",
    "crumbs": [
      "First chapter: Analyzing accuracy of formalisms in crop model when adding shoot structural variability",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Dynamic model</span>"
    ]
  },
  {
    "objectID": "dynamic_model.html#fit-plant-growth-and-development-to-lait-and-heightt-curves",
    "href": "dynamic_model.html#fit-plant-growth-and-development-to-lait-and-heightt-curves",
    "title": "4  Dynamic model",
    "section": "4.5 Fit plant growth and development to LAI(t) and height(t) curves",
    "text": "4.5 Fit plant growth and development to LAI(t) and height(t) curves\nLAI(t) curve\n\n\nCode\ndef linear_LA(x, slope=5, intercept=0.0):\n    \"\"\"\n    Generate a linear curve.\n\n    Args:\n    - x: Input values\n    - slope: Slope of the line\n    - intercept: Intercept of the line\n\n    Returns:\n    - y: Output values corresponding to the linear curve\n    \"\"\"\n    y = slope * x + intercept\n    return y\n\n\nTwo constraints :\n\\[ \\mathcal{A} = \\mathcal{A_scaled} = 2 * w * |\\int_{0}^{L} \\mathcal{C}(\\frac{s(u)}{L})d\\frac{s(u)}{L}| \\] \\[ \\text{leaf length} = L * e^{-\\log(skew) * (2 * (r - rmax)^2 + (r - rmax)^3)} \\] r = np.linspace(1. / nb_phy, 1, nb_phy)\n\n\nCode\nfrom archicrop.plant_shape import compute_leaf_area\n\ncompute_leaf_area(g)\n\n\n(6298.866898757795,\n [73.7853448407042,\n  90.72060237418295,\n  109.42356888758815,\n  201.67537532632647,\n  245.077108970223,\n  288.67084540115076,\n  327.7876562446977,\n  356.77089567182355,\n  579.7774334129538,\n  606.9865794382832,\n  601.8457357316205,\n  562.1067475553564,\n  491.6970230418619,\n  627.4649058939882,\n  504.04024269510165,\n  374.68587154744324,\n  256.3509617244893])\n\n\n\n\nCode\nfrom scipy.optimize import curve_fit\n\n# Define your parametric model as a Python function\ndef parametric_model(x):\n    \"\"\"\n    Define your parametric model here.\n\n    Args:\n    - x: Input values\n    - param1, param2, ...: Parameters of your model\n\n    Returns:\n    - y: Output values corresponding to the model\n    \"\"\"\n    for t in \n        # Compute your model's output based on input values and parameters\n        ## Code for generating a 3D cereal shoot from descritive parameters\n        # Parameters \n        diam_base=2.5\n        diam_top=1.0\n        # Lejeune and Bernier formula + col =\n        nb_young_phy = int(round((nb_phy - 1.95) / 1.84 / 1.3))\n        # stem diameters\n        diameter = ([diam_base] * nb_young_phy + np.linspace(diam_base, diam_top, nb_phy - nb_young_phy).tolist()) \n        height=1000                 # from crop model\n        nb_phy=17                   # fixed max nb of phytomers\n        max_leaf_length=70 \n        insertion_angle=40\n        scurv=0.7\n        curvature=80\n        phyllotactic_angle=180\n        spiral=False\n        \n        # Functions calls\n        insertion_heights=np.array(geometric_dist(height, \n                                                  nb_phy, \n                                                  q=1.25)) # further separate stem and pseudo stem, cf simple maize\n        \n        leaf_lengths=np.array(bell_shaped_dist(max_leaf_length=max_leaf_length, \n                                               nb_phy=nb_phy, \n                                               rmax=0.7, \n                                               skew=0.15)) # plant area --&gt; max leaf length\n        # leaf_areas=bell_shaped_dist(plant_area=1, nb_phy=15, rmax=0.7, skew=0.15) # cf blade_dimension\n        \n        a_leaf = parametric_leaf(nb_segment=10, \n                                 insertion_angle=insertion_angle, \n                                 scurv=scurv, \n                                 curvature=curvature, \n                                 alpha=-2.3)\n        \n        leaf_shapes = [a_leaf for l in leaf_lengths] # possible to replace leaf_length by nb_phy or...\n        \n        leaf_azimuths = leaf_azimuth(size=len(leaf_lengths), \n                                     phyllotactic_angle=phyllotactic_angle, \n                                     phyllotactic_deviation=0, \n                                     plant_orientation=0, \n                                     spiral=spiral)\n        \n        shoot, g = build_shoot(stem_diameters=stem_radius, \n                                      insertion_heights=insertion_heights, \n                                      leaf_lengths=leaf_lengths, \n                                      leaf_areas=None, \n                                      leaf_shapes=leaf_shapes, \n                                      leaf_azimuths=leaf_azimuths)\n    y = compute_leaf_area(g)\n    # # Build and display scene\n    # scene, nump = build_scene(g, \n    #                           leaf_material=Material(nice_green), \n    #                           stem_material=Material(nice_green))\n    # # display_scene(scene_single) # display in separate window\n    # PlantGL(scene) # display in notebook\n    return y\n\n# Prepare your data\nx_data = []\ny_data = []\nfor t in range(0,1700,100):\n    x_data.append(t)\n    y_data.append(linear_LA(t))\nx_data = np.array(x_data)  # Your input data\ny_data = np.array(y_data)  # Your output data\n\n# Use scipy.optimize.curve_fit to fit your model to the data and obtain optimal parameters\ninitial_guess = [...]  # Initial guess for your parameters\noptimal_params, covariance = curve_fit(parametric_model, x_data, y_data, p0=initial_guess)\n\n# Print the optimal parameters\nprint(\"Optimal Parameters:\", optimal_params)\n\n# Optionally, visualize the fit\nimport matplotlib.pyplot as plt\nplt.scatter(x_data, y_data, label='Data')\nplt.plot(x_data, parametric_model(x_data, *optimal_params), color='red', label='Fitted Curve')\nplt.xlabel('x')\nplt.ylabel('y')\nplt.legend()\nplt.show()\n\n\nSyntaxError: invalid syntax (1157590130.py, line 15)",
    "crumbs": [
      "First chapter: Analyzing accuracy of formalisms in crop model when adding shoot structural variability",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Dynamic model</span>"
    ]
  },
  {
    "objectID": "dynamic_model.html#next-steps",
    "href": "dynamic_model.html#next-steps",
    "title": "4  Dynamic model",
    "section": "4.6 Next steps",
    "text": "4.6 Next steps\n\nBending dynamics of leaves and tillers",
    "crumbs": [
      "First chapter: Analyzing accuracy of formalisms in crop model when adding shoot structural variability",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Dynamic model</span>"
    ]
  },
  {
    "objectID": "year_2.html",
    "href": "year_2.html",
    "title": "Second chapter : Analyzing accuracy of formalisms in crop model when adding root structural variability",
    "section": "",
    "text": "Analysis - root : Would considering root structure in an intercropping system be relevant for crop models ?\nHypothesis: The error of crop models, when it comes to modeling intercrops, are mainly due to the average plant hypothesis and the non-consideration of the plant root architecture.\nCreate a dynamic root FSPM for all 4 plants (cf lit), that enables to constrain root growth with density=f(depth) from STICS, in STICS’ 1D soil.\nImplement well-known structural reactions to stresses.\n(january -&gt; march 2025)\nRun simulations with both FSPM and STICS (stressless and stressed conditions : Vezy et al., 2023; Traore et al., 2022, 2023), varying (define variations ranges) when possible: root structures, spatial arrangement (with all same plants or all different to separate effects), env/stresses (N, water, light)\n(april -&gt; june 2025)\nFrom outputs from my models and from STICS for given processes and given conditions:\nCompare means and analyze variance of chosen output variables: water and N uptake, N fixing, etc.\nAnalyse uncertainty propagation in simulations; expected results: see which processes (integrated in root density) are the most impacted by the uncertainty in STICS’ root density.\nAnalyse sensitivity of some plant processes to structural variability (and spatial heterogeneity). Expected results: spot parameters of interest to implement in STICS as a parameter or different equation.\n(july -&gt; october 2025)\nCouple shoot and root models (when ?)\nCollaboration with post-doc from WUR, Jie Lu",
    "crumbs": [
      "Second chapter : Analyzing accuracy of formalisms in crop model when adding root structural variability"
    ]
  },
  {
    "objectID": "intro_2.html",
    "href": "intro_2.html",
    "title": "5  Introduction",
    "section": "",
    "text": "In progress …",
    "crumbs": [
      "Second chapter : Analyzing accuracy of formalisms in crop model when adding root structural variability",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "year_3.html",
    "href": "year_3.html",
    "title": "Third chapter: Improving STICS",
    "section": "",
    "text": "Modeling : How to model intercrops more accurately at crop scale, considering spatial issues when needed ?\nHypothesis: New crop models formalisms created through a multiscale approach would enable a better accuracy of the crop models.\nWhich formalisms would enable to translate spatial and structural considerations for chosen plant processes in a crop model ?\nFor each plant process targeted previously:\n- Develop formalisms to implement in STICS, by any appropriate method.\n- Run simulations and compare with simulations with previous version and with field data, to make sure new version of STICS fits data even better. (see with Mathilde de Freitas ?)\n(2026)",
    "crumbs": [
      "Third chapter: Improving STICS"
    ]
  },
  {
    "objectID": "intro_3.html",
    "href": "intro_3.html",
    "title": "6  Introduction",
    "section": "",
    "text": "In progress …",
    "crumbs": [
      "Third chapter: Improving STICS",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introduction</span>"
    ]
  }
]